<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>zip已知明文攻击 | JiuCheng's BLOG</title><meta name="author" content="JiuCheng"><meta name="copyright" content="JiuCheng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="zip已知明文攻击加密算法ZIP的加密算法大致分为两种ZipCrypto和AES-256,各自又分Deflate和Store。  ZipCrypto Deflate ZipCrypto Store AES-256 Deflate AES-256 Store  ZipCrypto算是传统的zip加密方式，只有使用ZipCrypto Deflate &#x2F;Store才可以使用 ZIP已知明文攻击">
<meta property="og:type" content="article">
<meta property="og:title" content="zip已知明文攻击">
<meta property="og:url" content="https://tgvhzg.github.io/2025/12/22/zip%E5%B7%B2%E7%9F%A5%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/index.html">
<meta property="og:site_name" content="JiuCheng&#39;s BLOG">
<meta property="og:description" content="zip已知明文攻击加密算法ZIP的加密算法大致分为两种ZipCrypto和AES-256,各自又分Deflate和Store。  ZipCrypto Deflate ZipCrypto Store AES-256 Deflate AES-256 Store  ZipCrypto算是传统的zip加密方式，只有使用ZipCrypto Deflate &#x2F;Store才可以使用 ZIP已知明文攻击">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://tgvhzg.github.io/pic/back4.jpg">
<meta property="article:published_time" content="2025-12-22T10:22:16.691Z">
<meta property="article:modified_time" content="2025-12-23T07:07:04.243Z">
<meta property="article:author" content="JiuCheng">
<meta property="article:tag" content="Misc">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tgvhzg.github.io/pic/back4.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "zip已知明文攻击",
  "url": "https://tgvhzg.github.io/2025/12/22/zip%E5%B7%B2%E7%9F%A5%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/",
  "image": "https://tgvhzg.github.io/pic/back4.jpg",
  "datePublished": "2025-12-22T10:22:16.691Z",
  "dateModified": "2025-12-23T07:07:04.243Z",
  "author": [
    {
      "@type": "Person",
      "name": "JiuCheng",
      "url": "https://tgvhzg.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/pic/head1.jpg"><link rel="canonical" href="https://tgvhzg.github.io/2025/12/22/zip%E5%B7%B2%E7%9F%A5%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":280,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'zip已知明文攻击',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/pic/background.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/pic/head1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/pic/back4.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">JiuCheng's BLOG</span></a><a class="nav-page-title" href="/"><span class="site-name">zip已知明文攻击</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">zip已知明文攻击</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-12-22T10:22:16.691Z" title="Created 2025-12-22 18:22:16">2025-12-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-12-23T07:07:04.243Z" title="Updated 2025-12-23 15:07:04">2025-12-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Misc/">Misc</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="zip已知明文攻击"><a href="#zip已知明文攻击" class="headerlink" title="zip已知明文攻击"></a>zip已知明文攻击</h1><h2 id="加密算法"><a href="#加密算法" class="headerlink" title="加密算法"></a>加密算法</h2><p>ZIP的加密算法大致分为两种ZipCrypto和AES-256,各自又分Deflate和Store。</p>
<blockquote>
<p>ZipCrypto Deflate</p>
<p>ZipCrypto Store</p>
<p>AES-256 Deflate</p>
<p>AES-256 Store</p>
</blockquote>
<p>ZipCrypto算是传统的zip加密方式，只有使用ZipCrypto Deflate &#x2F;Store才可以使用 ZIP已知明文攻击进行破解。</p>
<p>如何查看zip的详细信息呢？这里可以使用工具zipinfo：</p>
<p><img src="https://pic1.imgdb.cn/item/694923c3c154427986d94ddb.png"></p>
<p><code>zipinfo</code> 是一个用于<strong>查看 ZIP 压缩包内部文件技术信息</strong>的命令行工具。它不需要解压文件，就可以列出压缩包内的文件名、文件大小、权限、压缩比率、时间戳等详细信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zipinfo [选项] 压缩包名.zip</span><br></pre></td></tr></table></figure>

<p>进行深度取证分析（选项  -v）</p>
<p>也可以用7zip查看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z l -slt sample.zip</span><br></pre></td></tr></table></figure>

<p>其中的Method值就为加密算法（用软件打开也可以直接看到）</p>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h3 id="Windows的ARCHPR"><a href="#Windows的ARCHPR" class="headerlink" title="Windows的ARCHPR"></a>Windows的<a target="_blank" rel="noopener" href="http://www.downcc.com/soft/130539.html">ARCHPR</a></h3><p>该工具通常需要一个完整的明文文件来进行明文攻击，要满足下面三个条件才能成功：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.完整的明文文件</span><br><span class="line">2.明文文件需要被相同的压缩算法标准压缩</span><br><span class="line">3.明文对应文件的加密算法需要是ZipCrypto Store</span><br></pre></td></tr></table></figure>

<p><img src="https://pic1.imgdb.cn/item/69492612c154427986d9649e.png"></p>
<p>添加文件即可</p>
<h3 id="Linux的bkcrack"><a href="#Linux的bkcrack" class="headerlink" title="Linux的bkcrack"></a>Linux的bkcrack</h3><p>该工具只需要知道加密压缩包内容的12个字节</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">至少已知明文的12个字节及偏移，其中至少8字节需要连续。</span><br><span class="line">明文对应的文件加密方式为ZipCrypto Store</span><br></pre></td></tr></table></figure>

<p>该方法对于ZIP加密的算法有要求，明文对应的文件加密方式需要为ZipCrypto Store</p>
<p>而遇到ZipCrypto Deflate加密的，解密后（另外文件为ZipCrypto Store加密）需要bkcrack&#x2F;tool内的inflate.py脚本再次处理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 inflate.py &lt; file &gt; fileoutput</span><br></pre></td></tr></table></figure>

<p><strong>工具安装</strong></p>
<p>克隆仓库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/kimci86/bkcrack.git</span><br><span class="line">cd bkcrack</span><br></pre></td></tr></table></figure>

<p>创建构建目录并编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<p>确认是否成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bkcrack</span><br></pre></td></tr></table></figure>

<p>配置环境变量（在任意目录都可使用）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 将 bkcrack 移动到 /usr/local/bin</span><br><span class="line">sudo cp bkcrack /usr/local/bin/</span><br><span class="line"></span><br><span class="line"># 赋予执行权限（通常默认已有，但为了保险）</span><br><span class="line">sudo chmod +x /usr/local/bin/bkcrack</span><br></pre></td></tr></table></figure>

<p><strong>bkcrack常用参数：</strong></p>
<blockquote>
<p>-c 提取的密文部分<br>-p 提取的明文部分<br>-x 压缩包内目标文件的偏移地址  部分已知明文值<br>-C 加密压缩包<br>-o offset  -p参数指定的明文在压缩包内目标文件的偏移量</p>
</blockquote>
<p><strong>得到内部密钥后使用bkcrack修改压缩包密码</strong></p>
<p>破解出压缩包的三段密钥后，可以用 -U 参数修改压缩包密码并导出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C flag.zip -k 三段密钥 -U out.zip 111</span><br></pre></td></tr></table></figure>



<h2 id="攻击"><a href="#攻击" class="headerlink" title="攻击"></a>攻击</h2><p>这里只讲使用bkcrack的明文攻击手段</p>
<h3 id="加密文本破解"><a href="#加密文本破解" class="headerlink" title="加密文本破解"></a>加密文本破解</h3><p><strong>文件准备：flag.zip</strong></p>
<blockquote>
<p>flag.txt内容为flag{16e371fa-0555-47fc-b343-74f6754f6c01}</p>
</blockquote>
<p><img src="https://pic1.imgdb.cn/item/69493669c154427986d9db0f.png"></p>
<p>可以看到压缩包为ZipCrypto Store加密，如果我们知道该文本部分明文，比如xxxxx16e371faxxxxxxxxxxxxxxxxx4f67xxxxxxxx</p>
<p>16e371fa转hex为3136653337316661</p>
<p>4f67转hex为34663637</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C flag.zip -c flag.txt -x 5 3136653337316661 -x 30 34663637</span><br></pre></td></tr></table></figure>

<p>得到内部密钥 b21e5df4 ab9a9430 8c336475</p>
<p>恢复flag.txt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C flag.zip -c flag.txt -k b21e5df4 ab9a9430 8c336475 -d flag_decrypted.txt</span><br></pre></td></tr></table></figure>

<p>得到flag{16e371fa-0555-47fc-b343-74f6754f6c01}</p>
<p><img src="https://pic1.imgdb.cn/item/69493d57c154427986d9f5b9.png"></p>
<h3 id="png文件破解"><a href="#png文件破解" class="headerlink" title="png文件破解"></a>png文件破解</h3><p><strong>文件准备：png.zip</strong></p>
<blockquote>
<p>flag.txt</p>
<p>2.png</p>
</blockquote>
<p><img src="https://pic1.imgdb.cn/item/69493f35c154427986d9fa00.png"></p>
<p>加密算法都为ZipCrypto Store，可以进行明文攻击</p>
<p>利用png文件头进行，标准PNG图片文件的<strong>文件头</strong>：</p>
<p>89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C png.zip -c 2.png -x 0 89504E470D0A1A0A0000000D49484452</span><br></pre></td></tr></table></figure>

<p>得到内部密钥 e0be8d5d 70bb3140 7e983fff</p>
<p>恢复flag.txt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C png.zip -c flag.txt -k e0be8d5d 70bb3140 7e983fff -d flag.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://pic1.imgdb.cn/item/6949420ac154427986da0228.png"></p>
<p>得到flag{2f09f201dc590e0ecd71a90272996666}</p>
<h3 id="利用压缩包格式破解"><a href="#利用压缩包格式破解" class="headerlink" title="利用压缩包格式破解"></a>利用压缩包格式破解</h3><p>将一个名为sample.txt的文件打包成zip压缩包后，你会发现文件名称会出现在压缩包文件头中，且<strong>偏移固定为30</strong>。且默认情况下，sample.zip也会作为该压缩包的名称</p>
<p><img src="https://pic1.imgdb.cn/item/6949429ec154427986da0389.png"></p>
<p>所以，当一个加密压缩包中存在另一个ZIP压缩包时，且能够知道或猜测该压缩包内的文件名称时，可以尝试进行已知明文攻击</p>
<p><strong>文件准备：test.zip</strong></p>
<blockquote>
<p>2.png</p>
<p>flag.zip</p>
</blockquote>
<p><img src="https://pic1.imgdb.cn/item/69494476c154427986da07de.png"></p>
<p>2.png为ZipCrypto Deflate加密，flag.zip为ZipCrypto Store加密</p>
<p>已知明文：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 8字节</span><br><span class="line">偏移为30的flag.txt，转为hex得到666c61672e747874</span><br><span class="line">2. 4字节</span><br><span class="line">flag.zip本身的文件头(hex)：504B0304</span><br></pre></td></tr></table></figure>

<p>进行明文攻击：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C test.zip -c flag.zip -x 0 504B0304 -x 30 666c61672e747874</span><br></pre></td></tr></table></figure>

<p>得到内部密钥 b21e5df4 ab9a9430 8c336475</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C test.zip -c flag.zip -k b21e5df4 ab9a9430 8c336475 -d flag.zip</span><br></pre></td></tr></table></figure>

<p>flag.zip可以直接成功解密，得到flag{16e371fa-0555-47fc-b343-74f6754f6c01}</p>
<p><img src="https://pic1.imgdb.cn/item/69494c40c154427986da2612.png"></p>
<p>但是若想解密2.png，由于是ZipCrypto deflate加密的，所以解密后需要bkcrack&#x2F;tool内的inflate.py脚本再次处理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C test.zip -c 2.png -k b21e5df4 ab9a9430 8c336475 -d 2.png</span><br><span class="line"></span><br><span class="line">python3 ~/ctf/bkcrack-1.7.0-Linux/tools/inflate.py &lt; 2.png &gt; 2_out.png</span><br></pre></td></tr></table></figure>

<p>之后就能得到完整可看的图像</p>
<h3 id="exe文件格式破解"><a href="#exe文件格式破解" class="headerlink" title="exe文件格式破解"></a>exe文件格式破解</h3><p>EXE文件默认加密情况下，不太会以store方式被加密，但它文件格式中的的明文及其明显，长度足够。如果加密ZIP压缩包出现以store算法存储的EXE格式文件，很容易进行破解</p>
<p>大部分exe中都有这相同一段，且<strong>偏移固定为64</strong>：</p>
<p><img src="https://pic1.imgdb.cn/item/6949471fc154427986da154f.png"></p>
<p>即</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000</span><br></pre></td></tr></table></figure>

<p><strong>文件准备：nc.zip</strong></p>
<blockquote>
<p>nc64.exe</p>
</blockquote>
<p><img src="https://pic1.imgdb.cn/item/694947acc154427986da17ff.png"></p>
<p>该程序为ZipCrypto Store加密，可以进行明文攻击</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C nc.zip -c nc64.exe -x 64 0E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000</span><br></pre></td></tr></table></figure>

<p>已知明文越多，攻击成功的速度越快，该内部密钥还是很快得到的： b21e5df4 ab9a9430 8c336475</p>
<p>恢复：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C nc.zip -c nc64.exe -k b21e5df4 ab9a9430 8c336475 -d nc64.exe</span><br></pre></td></tr></table></figure>

<p><img src="https://pic1.imgdb.cn/item/69494e28c154427986da2847.png"></p>
<h3 id="流量包pcapng格式解密"><a href="#流量包pcapng格式解密" class="headerlink" title="流量包pcapng格式解密"></a>流量包pcapng格式解密</h3><p>利用pcapng文件头进行明文攻击</p>
<p><img src="https://pic1.imgdb.cn/item/69494a3dc154427986da215d.png"></p>
<p>红色部分是固定的：BlockType始终为0A0D0D0A；BlockTotalLength是小端存储的Header长度，显然不会超过64KB，所以高两位都是00；Byte-Order Magic在小端机器上始终为4D3C2B1A；Major Version目前只有0100；Minor Version目前只有0000。</p>
<p>这样可以知道文件中的4+10字节内容，满足明文攻击的要求</p>
<p>其实蓝色部分也是可以猜出来的：SectionLength是可选字段，大多数软件（比如WireShark）在保存pcapng时会写入-1（即8个字节的FF）</p>
<p>因此，把蓝色部分也算上的话，我们知道文件中的4+18字节内容，对明文攻击绰绰有余了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 4字节</span><br><span class="line">偏移为0</span><br><span class="line">0A 0D 0D 0A</span><br><span class="line">2. 18字节</span><br><span class="line">偏移为6</span><br><span class="line">00 00 4D 3C 2B 1A 01 00 00 00 FF FF FF FF FF FF FF FF</span><br></pre></td></tr></table></figure>

<p>因此可以构造明文攻击</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C file.zip -c file -x 0 0A0D0D0A -x 6 00004D3C2B1A01000000FFFFFFFFFFFFFFFF</span><br></pre></td></tr></table></figure>



<h3 id="网站相关文件破解"><a href="#网站相关文件破解" class="headerlink" title="网站相关文件破解"></a>网站相关文件破解</h3><p>网站目录中充斥着大量类型的文件，哪怕被打包成加密ZIP，也很容易找到突破口</p>
<p>例如</p>
<blockquote>
<p>robots.txt的文件开头内容通常是<code>User-agent: *</code><br>html文件开头通常是 <code>&lt;!DOCTYPE html&gt;</code><br>xml文件开头通常是<code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</code></p>
</blockquote>
<p><strong>文件准备：xml.zip</strong></p>
<p>网站目录肯定会涉及到多级目录，进行模拟。在文件夹中创建一个二级目录“123”，并将一个web.xml放入该二级目录中，然后打包成加密ZIP</p>
<blockquote>
<p>123&#x2F;web.xml</p>
<p>555.jpg</p>
</blockquote>
<p><img src="https://pic1.imgdb.cn/item/69494f2cc154427986da2923.png"></p>
<p>是ZipCrypto Store加密，可以进行明文攻击</p>
<p><strong>常见xml文件头为：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br></pre></td></tr></table></figure>

<p>hex：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e</span><br></pre></td></tr></table></figure>

<p>构造明文攻击：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C xml.zip -c 123/web.xml -x 0 3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e</span><br></pre></td></tr></table></figure>

<p>得到内部密钥：   e0be8d5d 70bb3140 7e983fff</p>
<p>恢复web.xml：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C xml.zip -c 123/web.xml -k e0be8d5d 70bb3140 7e983fff -d web.xml</span><br></pre></td></tr></table></figure>

<p><img src="https://pic1.imgdb.cn/item/6949532ac154427986da30ab.png"></p>
<h3 id="SVG文件格式破解"><a href="#SVG文件格式破解" class="headerlink" title="SVG文件格式破解"></a>SVG文件格式破解</h3><p>xml格式的文件除了.xml以外，也包括.svg文件。SVG是一种基于XML的图像文件格式</p>
<p>文件头：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;</span><br></pre></td></tr></table></figure>

<p>转hex为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3c 3f 78 6d 6c 20 76 65 72 73 69 6f 6e 3d 22 31 2e 30 22</span><br></pre></td></tr></table></figure>

<p><strong>文件准备：secrets.zip</strong></p>
<blockquote>
<p>spiral.svg</p>
<p>advice.jpg</p>
</blockquote>
<p><img src="https://pic1.imgdb.cn/item/694a04a712468c0fdca3fa00.png"></p>
<p>spiral.svg为ZipCrypto Store加密，可以明文攻击</p>
<p>构造明文攻击：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C secrets.zip -c spiral.svg -x 0 3c3f786d6c2076657273696f6e3d22312e3022</span><br></pre></td></tr></table></figure>

<p>得到内部密钥： c4038591 d5ff449d d3b0c696</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C secrets.zip -c spiral.svg -k c4038591 d5ff449d d3b0c696 -d spiral.svg</span><br></pre></td></tr></table></figure>

<p>针对deflate算法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C secrets.zip -c advice.jpg -k c4038591 d5ff449d d3b0c696 -d advice.jpg</span><br><span class="line"></span><br><span class="line">python3 ~/ctf/bkcrack-1.7.0-Linux/tools/inflate.py &lt; advice.jpg &gt; advice_out.jpg</span><br></pre></td></tr></table></figure>

<p><img src="https://pic1.imgdb.cn/item/6949557dc154427986da4d56.png"></p>
<h3 id="pyc文件格式破解"><a href="#pyc文件格式破解" class="headerlink" title="pyc文件格式破解"></a>pyc文件格式破解</h3><p>例题：minivnctf的<strong>D u know Pyc？</strong></p>
<p><img src="https://pic1.imgdb.cn/item/6949fbdc30bd482aed7dd3a0.png"></p>
<p>满足明文攻击，很明显是想对pyc文件进行攻击，且注释有</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python 3.12.12</span><br><span class="line">Bit Field为00 00 00 00</span><br><span class="line">hash 字段非置空</span><br></pre></td></tr></table></figure>

<p>明文攻击的条件为：至少已知明文的12个字节及偏移，其中至少8字节需要连续</p>
<p>让我们先来了解一下pyc文件的结构</p>
<p><img src="https://pic1.imgdb.cn/item/6949575fc154427986da5c57.png"></p>
<p>分别来看，最开始的4个字节是魔数，与python版本信息有关，是<strong>CB 0D 0D 0A</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> importlib.util</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取魔数（bytes类型）</span></span><br><span class="line">magic = importlib.util.MAGIC_NUMBER</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印十六进制表示</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Hex: <span class="subst">&#123;magic.<span class="built_in">hex</span>(<span class="string">&#x27; &#x27;</span>).upper()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印字节数组表示</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Bytes: <span class="subst">&#123;<span class="built_in">list</span>(magic)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>Bit Field为<strong>00 00 00 00</strong></p>
<p>因此到这里，我们已经知道了八个字节<strong>CB0D0D0A00000000</strong></p>
<p>同时有一个注意的点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyc产生的时间，事实上是py文件最后修改的时间，大小也是指py文件的大小</span><br></pre></td></tr></table></figure>

<p>那么我们可以从文件大小入手，flag.py原始大小是1411字节，转为4字节的16进制表示为：<strong>83050000</strong></p>
<p>我们已经具备明文攻击的条件了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">偏移量为0（共8字节）：</span><br><span class="line">CB0D0D0A00000000</span><br><span class="line"></span><br><span class="line">偏移量为12（共4字节）：</span><br><span class="line">83050000</span><br></pre></td></tr></table></figure>

<p>因此可以构造明文攻击的语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C flag.zip -c attack_it.pyc -x 0 CB0D0D0A00000000 -x 12 83050000</span><br></pre></td></tr></table></figure>

<p><img src="https://pic1.imgdb.cn/item/694957d4c154427986da5f99.png"></p>
<p>使用内部密钥恢复：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C flag.zip -c flag.py -k d7fe0787 b3af2704 99fa95dc -d flag.py</span><br></pre></td></tr></table></figure>



<h3 id="tar文件格式破解"><a href="#tar文件格式破解" class="headerlink" title="tar文件格式破解"></a>tar文件格式破解</h3><p>例题：LilCTF的<strong>提前放出附件</strong></p>
<p><img src="https://pic1.imgdb.cn/item/6949fc5612468c0fdca3e411.png"></p>
<p>可以进行明文攻击</p>
<p>根据tar文件结构：<a target="_blank" rel="noopener" href="https://docs.fileformat.com/zh/compression/tar/">https://docs.fileformat.com/zh/compression/tar/</a> 有多处可以用于构造明文攻击的已知明文。</p>
<p>且tar文件头内未使用的字段用 NUL 字节填充。标头由 257 个字节组成，用 NUL 字节填充以使其填充到 512 个字节的记录。例如：magic字段有固定的<code>.ustar</code>6个字节、文件名字段有100个字节，一般情况是用不满的，剩余部分将会填充为0。</p>
<p>因此使用文件名字段剩余字节尝试明文攻击，成功获得三段密钥。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C flagtest.zip -c flag.tar -x 40 000000000000000000000000</span><br></pre></td></tr></table></figure>

<p><img src="https://pic1.imgdb.cn/item/6949fea530bd482aed7ddd32.png"></p>
<p>这里偏移也可为其他的数值</p>
<h3 id="VMDK文件格式破解"><a href="#VMDK文件格式破解" class="headerlink" title="VMDK文件格式破解"></a>VMDK文件格式破解</h3><p>可利用文件头进行攻击</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4B444D560100000003000000</span><br></pre></td></tr></table></figure>

<p>构造明文攻击</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C flag.zip -c flag.vmdk -x 0 4B444D560100000003000000</span><br></pre></td></tr></table></figure>

<p>得到内部密钥解密即可破解压缩包</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>当然还有其他文件格式可以破解，我们做题的时候要去仔细分析文件的数据，查找可利用的明文</p>
<p>本文参考于</p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/network/255145.html">https://www.freebuf.com/articles/network/255145.html</a></p>
<p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/misc/archive/zip/#_6">https://ctf-wiki.org/misc/archive/zip/#_6</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://tgvhzg.github.io">JiuCheng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://tgvhzg.github.io/2025/12/22/zip%E5%B7%B2%E7%9F%A5%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/">https://tgvhzg.github.io/2025/12/22/zip%E5%B7%B2%E7%9F%A5%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Misc/">Misc</a></div><div class="post-share"><div class="social-share" data-image="/pic/back4.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/12/25/pyminifier/" title="pyminifier混淆器"><img class="cover" src="/pic/back5.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">pyminifier混淆器</div></div><div class="info-2"><div class="info-item-1">pyminifier项目地址Pyminifier 是一个 Python 代码压缩器、混淆器和压缩器 https://github.com/liftoff/pyminifier 安装这里以Ubuntu为例（在虚拟环境下） 下载源码包123wget https://files.pythonhosted.org/packages/source/p/pyminifier/pyminifier-2.1.tar.gztar -xzvf pyminifier-2.1.tar.gzcd pyminifier-2.1  手动运行 2to3 转换代码12to3 -w .  若没有2to3，安装即可 1sudo apt install 2to3  修改setup.py代码12345678910111213141516171819202122232425262728293031323334353637383940414243import sysimport pyminifierfrom setuptools import setupfrom distutils.command.install impor...</div></div></div></a><a class="pagination-related" href="/2025/12/21/DASCTF2025%E4%B8%8B%E5%8D%8A%E5%B9%B4%E8%B5%9B/" title="DASCTF2025下半年赛Misc复现"><img class="cover" src="/pic/back2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">DASCTF2025下半年赛Misc复现</div></div><div class="info-2"><div class="info-item-1">DASCTF2025下半年赛Misc官方wp： https://www.yuque.com/chuangfeimeiyigeren/eeii37/pyuic5kgzp3xe3tg?singleDoc#RCpLM DigitalSignature题目描述： 12Find out the signer. Maybe you need EIP-191. Flag is account address that wrapped by DASCTF&#123;&#125;.找出签名者。可能需要使用EIP-191。Flag是包裹在DASCTF&#123;&#125;中的账户地址。  附件task.py内容为： 12345678910111213141516171819202122232425262728293031from web3 import Web3from eth_account.messages import encode_defunctfrom Crypto.Util.number import bytes_to_longdef SignMessage(Message: str,...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/12/20/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81-volatility3%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" title="内存取证-volatility3工具的使用"><img class="cover" src="/pic/back3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-20</div><div class="info-item-2">内存取证-volatility3工具的使用</div></div><div class="info-2"><div class="info-item-1">内存取证-volatility3工具的使用安装 下载 (下载最新的源码包)  1wget https://github.com/volatilityfoundation/volatility3/archive/refs/tags/v2.5.2.zip -O volatility3.zip   解压  1unzip volatility3.zip   安装依赖（这是 Vol 3 必须多做的一步）  Volatility3需要一些Python库才能工作，不装会报错 12cd volatility3-2.5.2pip3 install -r requirements.txt  当然在这一步，可以会遇到下面这种情况：  这里需要创建一个虚拟环境，就可以正常安装依赖了 12345678#安装 venv 模块 (如果尚未安装)sudo apt install -y python3-venv#创建名为 venv 的虚拟环境python3 -m venv 虚拟环境名#激活虚拟环境source 虚拟环境名/bin/activate  1pip install -r requirements.txt...</div></div></div></a><a class="pagination-related" href="/2025/10/29/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81-volatility2%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" title="内存取证-volatility2工具的使用"><img class="cover" src="/pic/background.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-29</div><div class="info-item-2">内存取证-volatility2工具的使用</div></div><div class="info-2"><div class="info-item-1">内存取证-volatility2工具的使用简介Volatility 是一个开源的、跨平台的高级内存取证框架。它专门用于从 RAM（随机存取存储器） 快照（通常称为内存转储）中提取数字证据。 取证的常见文件后缀：.vmem &#x2F; .dump &#x2F; .raw &#x2F; .img 安装这里以ubuntu为例，这里有两个方法，一个是源码安装，另一个是使用独立可执行文件，区别在于前者有完整的插件功能，但是需要配置环境 方法一：源码安装（推荐，功能最全） 这个方法可以让你使用完整的插件功能 第一步：安装系统依赖 首先更新软件源，并安装构建工具和 Python 2 的基础支持。 12sudo apt updatesudo apt install -y python2 python2-dev libpython2-dev build-essential git libdistorm3-dev yara libraw1394-11 libcap2-bin  第二步：手动安装 Python 2 的 pip 由于 Ubuntu 仓库中不再提供 python-pip，我们需要从官方归...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/pic/head1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">JiuCheng</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/TGVhZg"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is JiuCheng's Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#zip%E5%B7%B2%E7%9F%A5%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB"><span class="toc-number">1.</span> <span class="toc-text">zip已知明文攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">加密算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7"><span class="toc-number">1.2.</span> <span class="toc-text">工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows%E7%9A%84ARCHPR"><span class="toc-number">1.2.1.</span> <span class="toc-text">Windows的ARCHPR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux%E7%9A%84bkcrack"><span class="toc-number">1.2.2.</span> <span class="toc-text">Linux的bkcrack</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB"><span class="toc-number">1.3.</span> <span class="toc-text">攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E6%96%87%E6%9C%AC%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.3.1.</span> <span class="toc-text">加密文本破解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#png%E6%96%87%E4%BB%B6%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.3.2.</span> <span class="toc-text">png文件破解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E5%8E%8B%E7%BC%A9%E5%8C%85%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.3.3.</span> <span class="toc-text">利用压缩包格式破解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exe%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.3.4.</span> <span class="toc-text">exe文件格式破解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E5%8C%85pcapng%E6%A0%BC%E5%BC%8F%E8%A7%A3%E5%AF%86"><span class="toc-number">1.3.5.</span> <span class="toc-text">流量包pcapng格式解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%AB%99%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.3.6.</span> <span class="toc-text">网站相关文件破解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SVG%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.3.7.</span> <span class="toc-text">SVG文件格式破解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pyc%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.3.8.</span> <span class="toc-text">pyc文件格式破解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tar%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.3.9.</span> <span class="toc-text">tar文件格式破解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VMDK%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.3.10.</span> <span class="toc-text">VMDK文件格式破解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-number">1.4.</span> <span class="toc-text">结语</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/12/25/pyminifier/" title="pyminifier混淆器"><img src="/pic/back5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pyminifier混淆器"/></a><div class="content"><a class="title" href="/2025/12/25/pyminifier/" title="pyminifier混淆器">pyminifier混淆器</a><time datetime="2025-12-25T05:01:15.079Z" title="Created 2025-12-25 13:01:15">2025-12-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/22/zip%E5%B7%B2%E7%9F%A5%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/" title="zip已知明文攻击"><img src="/pic/back4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="zip已知明文攻击"/></a><div class="content"><a class="title" href="/2025/12/22/zip%E5%B7%B2%E7%9F%A5%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/" title="zip已知明文攻击">zip已知明文攻击</a><time datetime="2025-12-22T10:22:16.691Z" title="Created 2025-12-22 18:22:16">2025-12-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/21/DASCTF2025%E4%B8%8B%E5%8D%8A%E5%B9%B4%E8%B5%9B/" title="DASCTF2025下半年赛Misc复现"><img src="/pic/back2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DASCTF2025下半年赛Misc复现"/></a><div class="content"><a class="title" href="/2025/12/21/DASCTF2025%E4%B8%8B%E5%8D%8A%E5%B9%B4%E8%B5%9B/" title="DASCTF2025下半年赛Misc复现">DASCTF2025下半年赛Misc复现</a><time datetime="2025-12-21T04:23:18.722Z" title="Created 2025-12-21 12:23:18">2025-12-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/20/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81-volatility3%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" title="内存取证-volatility3工具的使用"><img src="/pic/back3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内存取证-volatility3工具的使用"/></a><div class="content"><a class="title" href="/2025/12/20/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81-volatility3%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" title="内存取证-volatility3工具的使用">内存取证-volatility3工具的使用</a><time datetime="2025-12-20T12:54:23.744Z" title="Created 2025-12-20 20:54:23">2025-12-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/18/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E7%BA%BF%E4%B8%8BMisc%E5%A4%8D%E7%8E%B0/" title="强网拟态线下Misc复现"><img src="/pic/back.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="强网拟态线下Misc复现"/></a><div class="content"><a class="title" href="/2025/12/18/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E7%BA%BF%E4%B8%8BMisc%E5%A4%8D%E7%8E%B0/" title="强网拟态线下Misc复现">强网拟态线下Misc复现</a><time datetime="2025-12-18T02:46:04.220Z" title="Created 2025-12-18 10:46:04">2025-12-18</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/pic/top_foot_img.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By JiuCheng</span></div><div class="footer_custom_text">I'm JiuCheng</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>