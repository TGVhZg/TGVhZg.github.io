<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>强网拟态线下Misc复现 | JiuCheng's BLOG</title><meta name="author" content="JiuCheng"><meta name="copyright" content="JiuCheng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="强网拟态线下Misc复现复现参考： https:&#x2F;&#x2F;goodlunatic.github.io&#x2F;posts&#x2F;353513a&#x2F; https:&#x2F;&#x2F;0ran9e.fun&#x2F;2025&#x2F;11&#x2F;30&#x2F;qwnt&#x2F;wp&#x2F; 泄漏的时间与电码123题目描述：你苦苦寻觅的东西或许就藏在他最显眼的地方hint1：ModR&#x2F;M  附件有以下三个  其中chal是elf可执行文件，chal.py内容如下： 1234567891">
<meta property="og:type" content="article">
<meta property="og:title" content="强网拟态线下Misc复现">
<meta property="og:url" content="https://tgvhzg.github.io/2025/12/18/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E7%BA%BF%E4%B8%8BMisc%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="JiuCheng&#39;s BLOG">
<meta property="og:description" content="强网拟态线下Misc复现复现参考： https:&#x2F;&#x2F;goodlunatic.github.io&#x2F;posts&#x2F;353513a&#x2F; https:&#x2F;&#x2F;0ran9e.fun&#x2F;2025&#x2F;11&#x2F;30&#x2F;qwnt&#x2F;wp&#x2F; 泄漏的时间与电码123题目描述：你苦苦寻觅的东西或许就藏在他最显眼的地方hint1：ModR&#x2F;M  附件有以下三个  其中chal是elf可执行文件，chal.py内容如下： 1234567891">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://tgvhzg.github.io/pic/back.png">
<meta property="article:published_time" content="2025-12-18T02:46:04.220Z">
<meta property="article:modified_time" content="2025-12-20T07:14:21.072Z">
<meta property="article:author" content="JiuCheng">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tgvhzg.github.io/pic/back.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "强网拟态线下Misc复现",
  "url": "https://tgvhzg.github.io/2025/12/18/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E7%BA%BF%E4%B8%8BMisc%E5%A4%8D%E7%8E%B0/",
  "image": "https://tgvhzg.github.io/pic/back.png",
  "datePublished": "2025-12-18T02:46:04.220Z",
  "dateModified": "2025-12-20T07:14:21.072Z",
  "author": [
    {
      "@type": "Person",
      "name": "JiuCheng",
      "url": "https://tgvhzg.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/pic/head1.jpg"><link rel="canonical" href="https://tgvhzg.github.io/2025/12/18/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E7%BA%BF%E4%B8%8BMisc%E5%A4%8D%E7%8E%B0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":280,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '强网拟态线下Misc复现',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/pic/background.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/pic/head1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/pic/back.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">JiuCheng's BLOG</span></a><a class="nav-page-title" href="/"><span class="site-name">强网拟态线下Misc复现</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">强网拟态线下Misc复现</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-12-18T02:46:04.220Z" title="Created 2025-12-18 10:46:04">2025-12-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-12-20T07:14:21.072Z" title="Updated 2025-12-20 15:14:21">2025-12-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Misc/">Misc</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="强网拟态线下Misc复现"><a href="#强网拟态线下Misc复现" class="headerlink" title="强网拟态线下Misc复现"></a>强网拟态线下Misc复现</h1><p>复现参考：</p>
<p><a target="_blank" rel="noopener" href="https://goodlunatic.github.io/posts/353513a/">https://goodlunatic.github.io/posts/353513a/</a></p>
<p><a target="_blank" rel="noopener" href="https://0ran9e.fun/2025/11/30/qwnt/wp/">https://0ran9e.fun/2025/11/30/qwnt/wp/</a></p>
<h2 id="泄漏的时间与电码"><a href="#泄漏的时间与电码" class="headerlink" title="泄漏的时间与电码"></a>泄漏的时间与电码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">题目描述：</span><br><span class="line">你苦苦寻觅的东西或许就藏在他最显眼的地方</span><br><span class="line">hint1：ModR/M</span><br></pre></td></tr></table></figure>

<p>附件有以下三个</p>
<p><img src="https://pic1.imgdb.cn/item/69436ceecf0d90563b3f6d87.png"></p>
<p>其中chal是elf可执行文件，chal.py内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">import random</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">class SecureTypewriter:</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.lfsr = 0x92 </span><br><span class="line">        self.time_unit = 0.005  </span><br><span class="line">        self.jitter = 0.001</span><br><span class="line">        self.base_overhead = 10</span><br><span class="line">        self.branch_penalty = 30 </span><br><span class="line">    def step_lfsr(self):</span><br><span class="line">        bit = ((self.lfsr &gt;&gt; 0) ^ (self.lfsr &gt;&gt; 2) ^ (self.lfsr &gt;&gt; 3) ^ (self.lfsr &gt;&gt; 4)) &amp; 1</span><br><span class="line">        self.lfsr = (self.lfsr &gt;&gt; 1) | (bit &lt;&lt; 7)</span><br><span class="line">        return self.lfsr</span><br><span class="line"></span><br><span class="line">    def scramble(self, val):</span><br><span class="line">        return ((val * 0x1F) + 0x55) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">    def process_char(self, char):</span><br><span class="line">        c = ord(char)</span><br><span class="line">        </span><br><span class="line">        k = self.step_lfsr()</span><br><span class="line">        </span><br><span class="line">        val = c ^ k</span><br><span class="line">        </span><br><span class="line">        base_ops = self.scramble(val)</span><br><span class="line">        </span><br><span class="line">        current_ops = self.base_overhead + base_ops</span><br><span class="line">        </span><br><span class="line">        if base_ops % 2 != 0:</span><br><span class="line">            current_ops += self.branch_penalty</span><br><span class="line">            </span><br><span class="line">        real_duration = current_ops * self.time_unit</span><br><span class="line">        </span><br><span class="line">        noise = random.uniform(-self.jitter, self.jitter)</span><br><span class="line">        total_time = max(0, real_duration + noise)</span><br><span class="line">        </span><br><span class="line">        return total_time</span><br><span class="line"></span><br><span class="line">    def process_text(self, text):</span><br><span class="line">        timings = []</span><br><span class="line">        for char in text:</span><br><span class="line">            elapsed = self.process_char(char)</span><br><span class="line">            timings.append(elapsed)</span><br><span class="line">        return timings</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    try:</span><br><span class="line">        with open(&quot;flag.txt&quot;, &quot;r&quot;) as f:</span><br><span class="line">            content = f.read().strip()</span><br><span class="line">    except FileNotFoundError:</span><br><span class="line">        print(&quot;Error: flag.txt not found.&quot;)</span><br><span class="line">        sys.exit(1)</span><br><span class="line">        </span><br><span class="line">    machine = SecureTypewriter()</span><br><span class="line">    print(f&quot;Processing &#123;len(content)&#125; characters with SecureTypewriter v2.0...&quot;)</span><br><span class="line">    </span><br><span class="line">    logs = machine.process_text(content)</span><br><span class="line">    </span><br><span class="line">    with open(&quot;timing.log&quot;, &quot;w&quot;) as f:</span><br><span class="line">        for t in logs:</span><br><span class="line">            f.write(f&quot;&#123;t:.6f&#125;\n&quot;)</span><br><span class="line">            </span><br><span class="line">    print(&quot;Processing complete. Timing data saved to timing.log&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>timing.log的内容为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">1.110270</span><br><span class="line">0.924169</span><br><span class="line">1.139244</span><br><span class="line">0.670085</span><br><span class="line">0.915054</span><br><span class="line">1.154452</span><br><span class="line">0.224613</span><br><span class="line">0.329060</span><br><span class="line">0.774615</span><br><span class="line">0.279617</span><br><span class="line">0.954166</span><br><span class="line">0.430143</span><br><span class="line">0.414914</span><br><span class="line">1.224826</span><br><span class="line">1.310686</span><br><span class="line">1.265828</span><br><span class="line">0.110950</span><br><span class="line">1.225669</span><br><span class="line">1.404647</span><br><span class="line">0.575287</span><br><span class="line">1.455927</span><br><span class="line">0.975492</span><br><span class="line">0.305642</span><br><span class="line">0.835893</span><br><span class="line">1.245893</span><br><span class="line">0.569651</span><br><span class="line">1.060266</span><br><span class="line">0.149129</span><br><span class="line">0.844243</span><br><span class="line">1.294104</span><br><span class="line">0.079101</span><br><span class="line">0.914897</span><br><span class="line">1.025389</span><br><span class="line">0.270495</span><br><span class="line">0.225577</span><br><span class="line">0.654189</span><br><span class="line">1.385665</span><br><span class="line">0.755860</span><br><span class="line">0.450597</span><br><span class="line">0.950750</span><br><span class="line">0.839268</span><br><span class="line">1.015624</span><br><span class="line">0.895000</span><br><span class="line">0.794687</span><br><span class="line">1.064966</span><br><span class="line">1.200042</span><br><span class="line">0.559413</span><br><span class="line">0.980588</span><br><span class="line">0.525959</span><br><span class="line">0.514992</span><br><span class="line">0.629261</span><br><span class="line">0.489585</span><br><span class="line">1.089786</span><br><span class="line">0.880690</span><br><span class="line">1.374392</span><br><span class="line">0.789075</span><br><span class="line">0.814771</span><br><span class="line">1.455273</span><br><span class="line">1.050996</span><br><span class="line">0.234891</span><br><span class="line">1.074220</span><br><span class="line">0.099300</span><br><span class="line">1.319762</span><br><span class="line">0.935773</span><br><span class="line">0.454985</span><br><span class="line">0.425895</span><br><span class="line">0.704892</span><br><span class="line">1.095786</span><br><span class="line">1.165433</span><br><span class="line">1.295589</span><br><span class="line">0.749113</span><br><span class="line">0.885320</span><br><span class="line">1.244904</span><br><span class="line">0.659642</span><br><span class="line">0.635889</span><br><span class="line">0.435427</span><br><span class="line">0.520476</span><br><span class="line">0.870549</span><br><span class="line">0.890145</span><br><span class="line">1.125522</span><br><span class="line">1.064915</span><br><span class="line">0.399210</span><br><span class="line">0.865873</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>是侧信道攻击的相关内容，模拟了一个“安全打字机”，在处理每个字符时，根据字符的值和内部状态产生了不同的计算量，从而导致处理时间不同，同时chal文件解包并反编译后发现代码逻辑与chal.py文件相同，先恢复timing.log的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">class Solver:</span><br><span class="line">    def __init__(self):</span><br><span class="line">        # 题目中硬编码的初始种子</span><br><span class="line">        self.lfsr = 0x92</span><br><span class="line">        self.base_overhead = 10</span><br><span class="line">        self.branch_penalty = 30</span><br><span class="line"></span><br><span class="line">    def step_lfsr(self):</span><br><span class="line">        # 完全复现题目中的 LFSR 逻辑</span><br><span class="line">        bit = ((self.lfsr &gt;&gt; 0) ^ (self.lfsr &gt;&gt; 2) ^ (self.lfsr &gt;&gt; 3) ^ (self.lfsr &gt;&gt; 4)) &amp; 1</span><br><span class="line">        self.lfsr = (self.lfsr &gt;&gt; 1) | (bit &lt;&lt; 7)</span><br><span class="line">        return self.lfsr</span><br><span class="line"></span><br><span class="line">    def scramble(self, val):</span><br><span class="line">        # 复现混淆逻辑</span><br><span class="line">        return ((val * 0x1F) + 0x55) &amp; 0xFF</span><br><span class="line"></span><br><span class="line">def solve():</span><br><span class="line">    log_file = &quot;timing.log&quot;</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        with open(log_file, &quot;r&quot;) as f:</span><br><span class="line">            content = f.read()</span><br><span class="line">    except FileNotFoundError:</span><br><span class="line">        print(f&quot;Error: &#123;log_file&#125; not found.&quot;)</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    # 使用正则提取所有的浮点数时间</span><br><span class="line">    # 这样可以忽略像 &quot;&quot; 这样的无关前缀</span><br><span class="line">    timings_str = re.findall(r&quot;(\d+\.\d+)&quot;, content)</span><br><span class="line">    timings = [float(t) for t in timings_str]</span><br><span class="line">    </span><br><span class="line">    print(f&quot;[*] Loaded &#123;len(timings)&#125; timing samples from &#123;log_file&#125;&quot;)</span><br><span class="line">    </span><br><span class="line">    solver = Solver()</span><br><span class="line">    recovered_text = &quot;&quot;</span><br><span class="line">    </span><br><span class="line">    # 定义待爆破的字符集：常用可打印字符 + 换行符</span><br><span class="line">    # 如果 flag 包含特殊字符，可以扩大到 range(256)</span><br><span class="line">    charset = list(range(32, 127)) + [10, 13] </span><br><span class="line">    </span><br><span class="line">    print(&quot;[*] Starting brute-force recovery...&quot;)</span><br><span class="line">    </span><br><span class="line">    for i, t in enumerate(timings):</span><br><span class="line">        # 1. 逆向计算操作数 (去除时间系数和噪音)</span><br><span class="line">        # ops = round(time / 0.005)</span><br><span class="line">        target_ops = int(round(t / 0.005))</span><br><span class="line">        </span><br><span class="line">        # 2. 获取当前轮次的密钥流 (必须与处理字符同步进行)</span><br><span class="line">        k = solver.step_lfsr()</span><br><span class="line">        </span><br><span class="line">        found_char = None</span><br><span class="line">        </span><br><span class="line">        # 3. 爆破字符</span><br><span class="line">        for c_code in charset:</span><br><span class="line">            # 模拟处理过程</span><br><span class="line">            val = c_code ^ k</span><br><span class="line">            base_ops = solver.scramble(val)</span><br><span class="line">            </span><br><span class="line">            # 计算理论开销</span><br><span class="line">            current_ops = solver.base_overhead + base_ops</span><br><span class="line">            if base_ops % 2 != 0:</span><br><span class="line">                current_ops += solver.branch_penalty</span><br><span class="line">            </span><br><span class="line">            # 匹配检查</span><br><span class="line">            if current_ops == target_ops:</span><br><span class="line">                found_char = chr(c_code)</span><br><span class="line">                break</span><br><span class="line">        </span><br><span class="line">        if found_char:</span><br><span class="line">            recovered_text += found_char</span><br><span class="line">        else:</span><br><span class="line">            recovered_text += &quot;?&quot;</span><br><span class="line">            print(f&quot;[!] Warning: No matching char found for sample &#123;i&#125; (ops=&#123;target_ops&#125;)&quot;)</span><br><span class="line"></span><br><span class="line">    print(&quot;\n&quot; + &quot;=&quot;*40)</span><br><span class="line">    print(&quot;Recovered Content:&quot;)</span><br><span class="line">    print(&quot;=&quot;*40)</span><br><span class="line">    print(recovered_text)</span><br><span class="line">    print(&quot;=&quot;*40)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure>

<p>得到恢复的表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">h i j k l m n</span><br><span class="line">8 9 0 / - _ =</span><br><span class="line">a b c d e f g</span><br><span class="line">v w x y z &#123; &#125;</span><br><span class="line">o p q r s t u</span><br><span class="line">1 2 3 4 5 6 7</span><br></pre></td></tr></table></figure>

<p>结合hint1：ModR&#x2F;M，可以在谷歌找到下面这个项目</p>
<p><img src="https://pic1.imgdb.cn/item/69436ffecf0d90563b3fa5f6.png"></p>
<p><a target="_blank" rel="noopener" href="https://github.com/woodruffw/steg86">https://github.com/woodruffw/steg86</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steg86 extract chal &gt; flag.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://pic1.imgdb.cn/item/694371cecf0d90563b3fb5b8.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">326a31306c206b6b6868203a332024206a686820346820326b32682024336a203468336b206a323068206a6a366c206b6b6c6c206c6c6b205e6a206b6b24686820306a6a202f7a203a3620356b24206a6a206a</span><br></pre></td></tr></table></figure>

<p>也就是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2j10l kkhh :3 $ jhh 4h 2k2h $3j 4h3k j20h jj6l kkll llk ^j kk$hh 0jj /z :6 5k$ jj j</span><br></pre></td></tr></table></figure>

<p>这是一段vim编辑操作，对应上面的字符表</p>
<table>
<thead>
<tr>
<th><strong>指令</strong></th>
<th><strong>坐标</strong></th>
<th><strong>字符</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>2j10l</code></td>
<td>(2, 10)</td>
<td><strong>f</strong></td>
</tr>
<tr>
<td><code>kkhh</code></td>
<td>(0, 8)</td>
<td><strong>l</strong></td>
</tr>
<tr>
<td><code>:3</code></td>
<td>(2, 0)</td>
<td><strong>a</strong></td>
</tr>
<tr>
<td><code>$</code></td>
<td>(2, 12)</td>
<td><strong>g</strong></td>
</tr>
<tr>
<td><code>jhh</code></td>
<td>(3, 10)</td>
<td><strong>{</strong></td>
</tr>
<tr>
<td><code>4h</code></td>
<td>(3, 6)</td>
<td><strong>y</strong></td>
</tr>
<tr>
<td><code>2k2h</code></td>
<td>(1, 4)</td>
<td><strong>0</strong></td>
</tr>
<tr>
<td><code>$3j</code></td>
<td>(4, 12)</td>
<td><strong>u</strong></td>
</tr>
<tr>
<td><code>4h3k</code></td>
<td>(1, 8)</td>
<td><strong>-</strong></td>
</tr>
<tr>
<td><code>j20h</code></td>
<td>(2, 0)</td>
<td><strong>a</strong></td>
</tr>
<tr>
<td><code>jj6l</code></td>
<td>(4, 6)</td>
<td><strong>r</strong></td>
</tr>
<tr>
<td><code>kkll</code></td>
<td>(2, 8)</td>
<td><strong>e</strong></td>
</tr>
<tr>
<td><code>llk</code></td>
<td>(1, 10)</td>
<td><strong>_</strong></td>
</tr>
<tr>
<td><code>^j</code></td>
<td>(2, 0)</td>
<td><strong>a</strong></td>
</tr>
<tr>
<td><code>kk$hh</code></td>
<td>(0, 10)</td>
<td><strong>m</strong></td>
</tr>
<tr>
<td><code>0jj</code></td>
<td>(2, 0)</td>
<td><strong>a</strong></td>
</tr>
<tr>
<td><code>/z</code></td>
<td>(3, 8)</td>
<td><strong>z</strong></td>
</tr>
<tr>
<td><code>:6</code></td>
<td>(5, 0)</td>
<td><strong>1</strong></td>
</tr>
<tr>
<td><code>5k$</code></td>
<td>(0, 12)</td>
<td><strong>n</strong></td>
</tr>
<tr>
<td><code>jj</code></td>
<td>(2, 12)</td>
<td><strong>g</strong></td>
</tr>
<tr>
<td><code>j</code></td>
<td>(3, 12)</td>
<td><strong>}</strong></td>
</tr>
</tbody></table>
<p><strong>flag{y0u-are_amaz1ng}</strong></p>
<h2 id="返璞归真"><a href="#返璞归真" class="headerlink" title="返璞归真"></a>返璞归真</h2><p>附件下载的压缩包存在伪加密，随波逐流工具直接自动修复了，解压时发现注释有<strong>hashisk3y</strong></p>
<p><img src="https://pic1.imgdb.cn/item/69437763cf0d90563b3feac7.png"></p>
<p>将图片拖入随波逐流中处理，发现文件尾还藏有一个bmp文件，分离出来得到：</p>
<p><img src="https://pic1.imgdb.cn/item/694378d8cf0d90563b3ffad6.png"></p>
<p>是paperback，之前在L3HCTF2025做到过，附上工具下载链接：<a target="_blank" rel="noopener" href="http://www.ollydbg.de/Paperbak/">http://www.ollydbg.de/Paperbak/</a></p>
<p>得到wow.txt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jNX+xu2QKBm23AUlwClt+3xDkQcJGjM=</span><br></pre></td></tr></table></figure>

<p>结合之前的hashisk3y，我们把之间的那张image.jpg删去末尾BMP的数据后MD5一下</p>
<p>001a62ee54d1c28a8b769ab5499011cb</p>
<p>是rc4解密，得到</p>
<p><img src="https://pic1.imgdb.cn/item/69437bdacf0d90563b401904.png"></p>
<p><strong>flag{examp13_f0r_r3a11}</strong></p>
<h2 id="猫咪电台"><a href="#猫咪电台" class="headerlink" title="猫咪电台"></a>猫咪电台</h2><p>附件得到1.wav和cat0.png</p>
<p>首先处理cat0.png图片，在随波逐流发现存在LSB隐写，其中的顺序为BGR，是一个png文件，到stegsolve里面导出文件</p>
<p><img src="https://pic1.imgdb.cn/item/69440d9145497398fe529869.png"></p>
<p>得到</p>
<p><img src="https://pic1.imgdb.cn/item/694411d645497398fe52c860.png"></p>
<p>flag part0： &#x3D;&#x3D;gNWRWTFRjY4IGV4sGczg0QzAFUyQTQ</p>
<p><img src="https://pic1.imgdb.cn/item/69441242a04b223093b3b59b.png"></p>
<p>得到part0：<strong>Ci4l10~</strong></p>
<p>接下来我们处理1.wav文件，可以发现该文件还藏有一个zip文件：</p>
<p><img src="https://pic1.imgdb.cn/item/6944f5372ce92a4f930fef66.png"></p>
<p>得到一个压缩包，里面有2.wav但是解压需要密码</p>
<p><img src="https://pic1.imgdb.cn/item/6944f5692ce92a4f930ff11b.png"></p>
<p>发现有两条很清晰的频率，猜测是RTTY</p>
<p><img src="https://pic1.imgdb.cn/item/6944f6762ce92a4f930ff599.png"></p>
<p>用minimodem解码，自动检测：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minimodem -a --rx rtty -i -f 1.wav</span><br></pre></td></tr></table></figure>

<p><img src="https://pic1.imgdb.cn/item/6944f7462ce92a4f930ffa2e.png"></p>
<p>得到flag1：<strong>R77YM30W1SFUN</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CQ CQ CQ DE CATHUB</span><br><span class="line">THIS IS CAT RADIO HUB MEOW MEOW MEOW</span><br><span class="line">WHISKERS THE CAT IS BROADCASTING</span><br><span class="line">PURRRRRRR PURRRRRRR PURRRRRRR</span><br><span class="line">FLAG PART1: R77YM30W1SFUN</span><br><span class="line">PASS IS 450KTFQY1D4KX8JB</span><br><span class="line">MEOW MEOW MEOW</span><br><span class="line">SKSK</span><br></pre></td></tr></table></figure>

<p>以及压缩包解压密码 450KTFQY1D4KX8JB</p>
<p><img src="https://pic1.imgdb.cn/item/694508912ce92a4f93111f29.png"></p>
<p>普通的音频采样率通常是 44100 Hz (44.1 kHz) 或 48000 Hz，这里的采样率是 <strong>2.4 MHz</strong>，这是无线电频谱的原始录制数据。这个采样率（2.4 MSps）是常见入门级 SDR 设备（如 RTL-SDR）的典型采样率，跑ai跑出来一个脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">import soundfile as sf</span><br><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">from scipy.signal import decimate</span><br><span class="line"></span><br><span class="line">def solve_radio_challenge(filename):</span><br><span class="line">    print(f&quot;[*] Loading &#123;filename&#125;...&quot;)</span><br><span class="line">    data, sample_rate = sf.read(filename)</span><br><span class="line">    </span><br><span class="line">    # 1. 转换为 IQ 信号</span><br><span class="line">    if data.ndim &gt; 1:</span><br><span class="line">        iq_signal = data[:, 0] + 1j * data[:, 1]</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;[!] Error: Data is not stereo.&quot;)</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    # 2. 自动寻找载波频率 (Auto-Tuning)</span><br><span class="line">    print(&quot;[*] Detecting carrier frequency...&quot;)</span><br><span class="line">    # 计算功率谱密度 (PSD) 来找到能量最强的点（那条黄线）</span><br><span class="line">    fft_size = 2048 * 8</span><br><span class="line">    psd = np.abs(np.fft.fft(iq_signal[:fft_size]))**2</span><br><span class="line">    freqs = np.fft.fftfreq(fft_size, d=1/sample_rate)</span><br><span class="line">    </span><br><span class="line">    # 找到峰值对应的频率</span><br><span class="line">    carrier_index = np.argmax(psd)</span><br><span class="line">    carrier_freq = freqs[carrier_index]</span><br><span class="line">    </span><br><span class="line">    print(f&quot;[+] Found strong signal at: &#123;carrier_freq/1000:.2f&#125; kHz&quot;)</span><br><span class="line"></span><br><span class="line">    # 3. 移频 (Frequency Shifting)</span><br><span class="line">    # 将信号乘以 e^(-j*2*pi*f*t) 把载波搬移到 0Hz</span><br><span class="line">    print(&quot;[*] Shifting signal to center (0 Hz)...&quot;)</span><br><span class="line">    t = np.arange(len(iq_signal)) / sample_rate</span><br><span class="line">    # 注意这里用负的 carrier_freq 来抵消偏移</span><br><span class="line">    shifted_signal = iq_signal * np.exp(-1j * 2 * np.pi * carrier_freq * t)</span><br><span class="line"></span><br><span class="line">    # 4. 降采样 (Downsampling)</span><br><span class="line">    # 原始 2.4MHz 包含太多噪音，我们需要“聚焦”到信号上</span><br><span class="line">    # 目标音频采样率 48kHz</span><br><span class="line">    target_rate = 48000</span><br><span class="line">    decimation_factor = int(sample_rate / target_rate)</span><br><span class="line">    </span><br><span class="line">    print(f&quot;[*] Decimating (Zooming in) by factor of &#123;decimation_factor&#125;...&quot;)</span><br><span class="line">    # 使用 scipy 的 decimate 自带低通滤波，比简单的切片更干净</span><br><span class="line">    try:</span><br><span class="line">        audio_iq = decimate(shifted_signal, decimation_factor, ftype=&#x27;fir&#x27;)</span><br><span class="line">    except:</span><br><span class="line">        # 如果数据量太大内存不够，回退到简单切片</span><br><span class="line">        audio_iq = shifted_signal[::decimation_factor]</span><br><span class="line"></span><br><span class="line">    # 5. 多种模式解调 (导出所有可能)</span><br><span class="line">    print(&quot;[*] Demodulating...&quot;)</span><br><span class="line"></span><br><span class="line">    # 模式 A: NFM (窄带调频) - CTF最常见</span><br><span class="line">    # 相位差 -&gt; 频率</span><br><span class="line">    phase = np.unwrap(np.angle(audio_iq))</span><br><span class="line">    audio_fm = np.diff(phase)</span><br><span class="line">    # 去除直流分量 (Center the audio)</span><br><span class="line">    audio_fm = audio_fm - np.mean(audio_fm)</span><br><span class="line">    # 归一化</span><br><span class="line">    audio_fm = audio_fm / np.max(np.abs(audio_fm))</span><br><span class="line">    sf.write(&quot;flag_FM.wav&quot;, audio_fm, target_rate)</span><br><span class="line">    print(&quot;[+] Saved: flag_FM.wav (Likely the answer)&quot;)</span><br><span class="line"></span><br><span class="line">    # 模式 B: AM (调幅) - 虽然看起来不像，但也生成一份备用</span><br><span class="line">    audio_am = np.abs(audio_iq)</span><br><span class="line">    audio_am = audio_am - np.mean(audio_am)</span><br><span class="line">    audio_am = audio_am / np.max(np.abs(audio_am))</span><br><span class="line">    sf.write(&quot;flag_AM.wav&quot;, audio_am, target_rate)</span><br><span class="line">    print(&quot;[+] Saved: flag_AM.wav&quot;)</span><br><span class="line">    </span><br><span class="line">    # 模式 C: SSB (单边带) - 直接听移频后的实部</span><br><span class="line">    audio_ssb = np.real(audio_iq)</span><br><span class="line">    audio_ssb = audio_ssb / np.max(np.abs(audio_ssb))</span><br><span class="line">    sf.write(&quot;flag_SSB.wav&quot;, audio_ssb, target_rate)</span><br><span class="line">    print(&quot;[+] Saved: flag_SSB.wav&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    solve_radio_challenge(&quot;2.wav&quot;)</span><br></pre></td></tr></table></figure>

<p>运行结果如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[*] Loading 2.wav...</span><br><span class="line">[*] Detecting carrier frequency...</span><br><span class="line">[+] Found strong signal at: -300.15 kHz</span><br><span class="line">[*] Shifting signal to center (0 Hz)...</span><br><span class="line">[*] Decimating (Zooming in) by factor of 50...</span><br><span class="line">[*] Demodulating...</span><br><span class="line">[+] Saved: flag_FM.wav (Likely the answer)</span><br><span class="line">[+] Saved: flag_AM.wav</span><br><span class="line">[+] Saved: flag_SSB.wav</span><br></pre></td></tr></table></figure>

<p>在flag_FM.wav里面可以听到类似于sstv音频特点的声音，使用MMSSTV得到</p>
<p><img src="https://pic1.imgdb.cn/item/694513982ce92a4f931184eb.png"></p>
<p><img src="https://pic1.imgdb.cn/item/694514512ce92a4f93118a94.png"></p>
<p>2nd part <strong>_C4T9L1V3S</strong></p>
<p>最后的flag：<strong>flag{Ci4l10~R77YM30W1SFUN_C4T9L1V3S}</strong></p>
<h2 id="标准的绝密压缩"><a href="#标准的绝密压缩" class="headerlink" title="标准的绝密压缩"></a>标准的绝密压缩</h2><p>是一道流量分析题目，我们追踪tcp流，可以发现有一些png数据（89504e47），手动提取并分别排序命名为12345…..（neta提取的图片数量不完全，而且没有顺序）</p>
<p><img src="https://pic1.imgdb.cn/item/694518b32ce92a4f9311abdd.png"></p>
<p>得到以下照片，而且它们的分辨率都为100 x 100<img src="https://pic1.imgdb.cn/item/69451e2b2ce92a4f9311b3c7.png"></p>
<p>用pngcheck检查一下，结果表明这个极有可能不是一张真正的图片，而是一段被伪装成PNG IDAT数据块的文本信息，将文本信息进行了zlib压缩，直接塞进了IDAT块</p>
<p><img src="https://pic1.imgdb.cn/item/6945857eb108dde6cf5e14ab.png"></p>
<p>脚本提取数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">import zlib</span><br><span class="line">import struct</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">def extract_text_from_fake_png(file_path):</span><br><span class="line">    try:</span><br><span class="line">        with open(file_path, &#x27;rb&#x27;) as f:</span><br><span class="line">            data = f.read()</span><br><span class="line">            # 寻找 IDAT 块</span><br><span class="line">            idat_offset = data.find(b&#x27;IDAT&#x27;)</span><br><span class="line">            if idat_offset == -1:</span><br><span class="line">                return None</span><br><span class="line">            </span><br><span class="line">            # 读取长度</span><br><span class="line">            length_bytes = data[idat_offset-4 : idat_offset]</span><br><span class="line">            length = struct.unpack(&#x27;&gt;I&#x27;, length_bytes)[0]</span><br><span class="line">            </span><br><span class="line">            # 提取并解压</span><br><span class="line">            compressed_data = data[idat_offset+4 : idat_offset+4+length]</span><br><span class="line">            try:</span><br><span class="line">                # 尝试标准解压</span><br><span class="line">                return zlib.decompress(compressed_data)</span><br><span class="line">            except:</span><br><span class="line">                # 尝试无 header 解压</span><br><span class="line">                return zlib.decompress(compressed_data, -15)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(f&quot;Error processing &#123;file_path&#125;: &#123;e&#125;&quot;)</span><br><span class="line">        return None</span><br><span class="line"></span><br><span class="line"># 主程序</span><br><span class="line">full_conversation = b&quot;&quot;</span><br><span class="line">index = 0</span><br><span class="line"></span><br><span class="line">print(&quot;开始批量提取...&quot;)</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    # 假设文件名为 0.png, 1.png, 2.png ...</span><br><span class="line">    filename = f&quot;&#123;index&#125;.png&quot;</span><br><span class="line">    </span><br><span class="line">    if not os.path.exists(filename):</span><br><span class="line">        break # 找不到文件则停止</span><br><span class="line">        </span><br><span class="line">    content = extract_text_from_fake_png(filename)</span><br><span class="line">    </span><br><span class="line">    if content:</span><br><span class="line">        print(f&quot;[&#123;filename&#125;] 提取成功&quot;)</span><br><span class="line">        full_conversation += content</span><br><span class="line">    else:</span><br><span class="line">        print(f&quot;[&#123;filename&#125;] 提取失败或非预期格式&quot;)</span><br><span class="line">    </span><br><span class="line">    index += 1</span><br><span class="line"></span><br><span class="line">print(&quot;\n&quot; + &quot;=&quot;*30)</span><br><span class="line">print(&quot;🎉 完整对话内容如下：&quot;)</span><br><span class="line">print(&quot;=&quot;*30)</span><br><span class="line"># 尝试解码为 utf-8 打印，如果失败则打印原始 bytes</span><br><span class="line">try:</span><br><span class="line">    print(full_conversation.decode(&#x27;utf-8&#x27;))</span><br><span class="line">except:</span><br><span class="line">    print(full_conversation)</span><br></pre></td></tr></table></figure>

<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connection established. Hey, you online? It’s been a while since we last talked.Yeah, I’m here. Busy as always. Feels like the days are getting shorter.Tell me about it. I barely have time to sleep lately. Between maintenance logs and incident reports, I’m drowning.Sounds rough. I’ve been buried in audits myself. Every time I finish one, another pops up.Classic. Sometimes I wonder if the machines are easier to deal with than the people.No kidding. At least machines don’t ask pointless questions.True. Anyway, before I forget—how’s that side project you were working on? The one you wouldn’t shut up about months ago.Still alive… barely. Progress is slow, but steady. You know me—I don’t give up easily.Good. I hope it pays off one day.Thanks. Alright… I’m guessing you didn’t ping me just to chat?Well, half of it was. It’s been a while. But yes—I do have something for you today. Before sending the core cipher, I’ll transmit an encrypted archive first. It contains a sample text and the decryption rules.Okay. What’s special about this sample text?And… inside the sample text, I used my favorite Herobrine legend—you know the one I always bring up.Of course I know. The hidden original text from that weird old site, right?What can I say—old habits die hard. Anyway, the important part: the sample packet and the core cipher are encrypted with the same password.Got it. So if I can decrypt the sample, the real one should be straightforward.Exactly. Send the sample when ready.I’m ready. Go ahead.UEsDBBQAAQAIABtFeFu1Ii0dcwAAAHwAAAAJAAAAcnVsZXMudHh07XuRBFDbojGKhAz59VaKEpwD6/rKaZnqUxf+NMH0rybWrAMPewZ/yGyLrMKQjNIcEbPAxjmP5oTh8fP77Vi1wnFwzN37BmrQ9SCkC27FC/xeqbgw/HWcDpgzsEoiNpqT9ZThrbAScyg5syfJmNactjelNVBLAwQUAAEACACGOXhbpdvG1ysBAAAVAgAACgAAAHNhbXBsZS50eHTA1fy4cMLZwZkTI1mEk88yOXy9rmbTbCNBQOo9hqKQPK6vjZVo9aCtTVflmkKYGV99+51qXbinmG7WGik5UvLJk9MKRosThBCDMHrmjibOCzjzNELwEgEyX8DjqJkSc8pIFwj+oRM3bb4i0GtRxbwqgsxCtgwiKdCVoXVdetN7RKLIQ7DD+Huv/ZptNdd0yRNHis9LEA3loB+IHZ+dK7IknqPh4lYF8JwAjx5/wwp0YAM6Bcec7uAvk6B5t1pEztm1rLl8TjniVz5/bBUTo1LjUXnar/pnm1NvE9EAuxz/s6b+O8/ew7/A4ItdNJGzDudh6YULfiV3pCTXFIbR4GCe4LwkohWZIlAjysA+zLRrgkTDoB10vWdNGdfoBAlLRoUdZ95mS7X5/bXV41BLAQI/ABQAAQAIABtFeFu1Ii0dcwAAAHwAAAAJACQAAAAAAAAAIAAAAAAAAABydWxlcy50eHQKACAAAAAAAAEAGABIv3f82lzcAQAAAAAAAAAAAAAAAAAAAABQSwECPwAUAAEACACGOXhbpdvG1ysBAAAVAgAACgAkAAAAAAAAACAAAACaAAAAc2FtcGxlLnR4dAoAIAAAAAAAAQAYAFP0sZjOXNwBAAAAAAAAAAAAAAAAAAAAAFBLBQYAAAAAAgACALcAAADtAQAAAAA=got it. Decrypting… yeah, it works.Good. That means the channel is stable.Alright. Whenever you’re ready, send the real thing.The core cipher will be transmitted through our secret channel. You remember how to decrypt it, right?Of course. I’ve got the procedure ready. Start when you’re ready.Done. Core cipher fully received. Integrity verified—no corruption.Same to you. And hey… nice talking again.Agreed. Take care.Good. Keep things quiet for the next few days.Yeah. Let’s not wait so long next time.You too.</span><br></pre></td></tr></table></figure>

<p>其中的一串字符是base64编码的加密zip压缩包，需要sample.txt作为明文进行明文攻击</p>
<p>结合对话中提到的Herobrine legend和weird old site可以在网上找到sample.txt：</p>
<p><img src="https://pic1.imgdb.cn/item/69458c2db108dde6cf5e1f0b.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">It has been reported that some victims of torture, during the act, would retreat into a fantasy world from which they could not WAKE UP. In this catatonic state, the victim lived in a world just like their normal one, except they weren&#x27;t being tortured. The only way that they realized they needed to WAKE UP was a note they found in their fantasy world. It would tell them about their condition, and tell them to WAKE UP. Even then, it would often take months until they were ready to discard their fantasy world and PLEASE WAKE UP.</span><br></pre></td></tr></table></figure>

<p>010查看加密压缩包的压缩方式，其加密的标志位为0x3F，猜测是用7z压缩的</p>
<p><img src="https://pic1.imgdb.cn/item/694588deb108dde6cf5e1b89.png"></p>
<p>进行明文攻击得到内部密钥：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b47e923c 5aeb49a7 a3cd7af0</span><br></pre></td></tr></table></figure>

<p>得到rules.txt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.you need to calc the md5 of port to decrypt the core data.</span><br><span class="line">2.The cipher I put in the zip, in segments, has been deflated.</span><br></pre></td></tr></table></figure>

<p>大致的思路利用对应的端口的MD5作为key解密内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r capture.pcapng -T fields -e tcp.srcport -e tcp.dstport -e tcp.payload &gt;1.txt</span><br></pre></td></tr></table></figure>

<p>刚提取出来的数据是分块的，如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">30012	8900	7c9062acee29aaa61768</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	9da62a4b8bed889e01e6</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	c50f8566ba622cef6583</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	2f65d15cab15cd5c17c9</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	937312dc74526dab11fa</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	c16788105bc707a25d50</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	f5fe8add47d10edc2567</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	e7f6570c7248dc81ad1a</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	bc19e44f6cd47a265fdf</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	baef0e08859931abe905</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	23b675657b57f930a53d</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	42f4e1f6062efd733db8</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	2d4fe08f08a1c98bd0c8</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	1c4cc46ee3cefcd7c136</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	58748a913c28656b1fd7</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	d1cb2029d9e76f67d043</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	c504e75a379c0700fc30</span><br><span class="line">8900	30012	</span><br><span class="line">30012	8900	ef8722dbb1ac</span><br></pre></td></tr></table></figure>

<p>也就是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7c9062acee29aaa617689da62a4b8bed889e01e6c50f8566ba622cef65832f65d15cab15cd5c17c9937312dc74526dab11fac16788105bc707a25d50f5fe8add47d10edc2567e7f6570c7248dc81ad1abc19e44f6cd47a265fdfbaef0e08859931abe90523b675657b57f930a53d42f4e1f6062efd733db82d4fe08f08a1c98bd0c81c4cc46ee3cefcd7c13658748a913c28656b1fd7d1cb2029d9e76f67d043c504e75a379c0700fc30ef8722dbb1ac</span><br></pre></td></tr></table></figure>

<p>对应端口号是30012，md5为7c365ebfc34003c40033cc47f6116dd1作为key</p>
<p>AES-ECB模式解密：</p>
<p><img src="https://pic1.imgdb.cn/item/6945907eb108dde6cf5e2416.png"></p>
<p>得到压缩包</p>
<p><img src="https://pic1.imgdb.cn/item/694590b3b108dde6cf5e245d.png"></p>
<p>大小为4字节，符合crc爆破的条件，写脚本提取所有的数据，进行爆破</p>
<p>以下脚本来自 Lunatic 师傅：<a target="_blank" rel="noopener" href="https://goodlunatic.github.io/posts/353513a/#%E9%A2%98%E7%9B%AE%E5%90%8D%E7%A7%B0-%E6%A0%87%E5%87%86%E7%9A%84%E7%BB%9D%E5%AF%86%E5%8E%8B%E7%BC%A9">https://goodlunatic.github.io/posts/353513a/#%E9%A2%98%E7%9B%AE%E5%90%8D%E7%A7%B0-%E6%A0%87%E5%87%86%E7%9A%84%E7%BB%9D%E5%AF%86%E5%8E%8B%E7%BC%A9</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">import subprocess</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from Crypto.Util.Padding import unpad</span><br><span class="line">import hashlib</span><br><span class="line">import zipfile</span><br><span class="line"></span><br><span class="line">def md5(data):</span><br><span class="line">    return hashlib.md5(data).hexdigest()</span><br><span class="line"></span><br><span class="line">def aes_ecb_decrypt(ciphertext, key):</span><br><span class="line">    if len(ciphertext) % 16 != 0:</span><br><span class="line">        ciphertext = ciphertext.ljust((len(ciphertext) + 15) // 16 * 16, b&#x27;\x00&#x27;)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    decrypted = cipher.decrypt(ciphertext)</span><br><span class="line">    return decrypted</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    file_path = &quot;capture.pcapng&quot;</span><br><span class="line">    crc_list = []</span><br><span class="line">    </span><br><span class="line">    for src_port in range(30012, 30092):</span><br><span class="line">        print(f&quot;[+] Processing source port: &#123;src_port&#125;&quot;)</span><br><span class="line">        aes_key = md5(str(src_port).encode())</span><br><span class="line">        print(f&quot;[+] aes_key: &#123;aes_key&#125;&quot;)</span><br><span class="line">        filter_str = f&quot;tcp.srcport == &#123;src_port&#125;&quot;</span><br><span class="line"></span><br><span class="line">        command = [</span><br><span class="line">            &quot;tshark&quot;,</span><br><span class="line">            &#x27;-r&#x27;, file_path,</span><br><span class="line">            &#x27;-T&#x27;, &#x27;fields&#x27;,</span><br><span class="line">            &#x27;-Y&#x27;, filter_str,</span><br><span class="line">            &#x27;-e&#x27;, &#x27;tcp.payload&#x27;</span><br><span class="line">        ]</span><br><span class="line">        # print(f&quot;[+] cmd: &#123;command&#125;&quot;)</span><br><span class="line">        result = subprocess.run(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)   </span><br><span class="line">        output = result.stdout.split()</span><br><span class="line">        if not output:</span><br><span class="line">            continue</span><br><span class="line">            </span><br><span class="line">        hex_data = &quot;&quot;.join(output)</span><br><span class="line">        # print(f&quot;[+] hex_data: &#123;hex_data&#125;&quot;)</span><br><span class="line">        zip_data = aes_ecb_decrypt(bytes.fromhex(hex_data), aes_key.encode())</span><br><span class="line">        # print(zip_data)</span><br><span class="line"></span><br><span class="line">        zip_filename = f&quot;&#123;src_port&#125;.zip&quot;</span><br><span class="line">        with open(zip_filename, &#x27;wb&#x27;) as f:</span><br><span class="line">            f.write(zip_data)</span><br><span class="line">        try:</span><br><span class="line">            with zipfile.ZipFile(zip_filename, &#x27;r&#x27;) as zf:</span><br><span class="line">                file_list = zf.namelist()</span><br><span class="line">                if file_list:</span><br><span class="line">                    target_file = file_list[0]</span><br><span class="line">                    info = zf.getinfo(target_file)</span><br><span class="line">                    crc_list.append(hex(info.CRC))</span><br><span class="line">        except:</span><br><span class="line">            print(f&quot;\033[1;31m[-] Failed to process zip for port &#123;src_port&#125;\033[0m&quot;)</span><br><span class="line">    </span><br><span class="line">    print(f&quot;CRC32 list: &#123;crc_list&#125;&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://pic1.imgdb.cn/item/69459613b108dde6cf5e2a14.png"></p>
<p>得到80个zip文件，都能crc爆破，写脚本批量爆破 crc：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">class CRC32Reverse:</span><br><span class="line">    def __init__(self, crc32, length, tbl=bytes(range(256)), poly=0xEDB88320, accum=0):</span><br><span class="line">        self.char_set = set(tbl)  # 支持所有字节</span><br><span class="line">        self.crc32 = crc32</span><br><span class="line">        self.length = length</span><br><span class="line">        self.poly = poly</span><br><span class="line">        self.accum = accum</span><br><span class="line">        self.table = []</span><br><span class="line">        self.table_reverse = []</span><br><span class="line"></span><br><span class="line">    def init_tables(self, poly, reverse=True):</span><br><span class="line">        &quot;&quot;&quot;构建 CRC32 表及其反向查找表&quot;&quot;&quot;</span><br><span class="line">        # CRC32 表构建</span><br><span class="line">        for i in range(256):</span><br><span class="line">            for j in range(8):</span><br><span class="line">                if i &amp; 1:</span><br><span class="line">                    i &gt;&gt;= 1</span><br><span class="line">                    i ^= poly</span><br><span class="line">                else:</span><br><span class="line">                    i &gt;&gt;= 1</span><br><span class="line">            self.table.append(i)</span><br><span class="line"></span><br><span class="line">        assert len(self.table) == 256, &quot;CRC32 表的大小错误&quot;</span><br><span class="line"></span><br><span class="line">        # 构建反向查找表</span><br><span class="line">        if reverse:</span><br><span class="line">            for i in range(256):</span><br><span class="line">                found = [j for j in range(256) if self.table[j] &gt;&gt; 24 == i]</span><br><span class="line">                self.table_reverse.append(tuple(found))</span><br><span class="line">            </span><br><span class="line">            assert len(self.table_reverse) == 256, &quot;反向查找表的大小错误&quot;</span><br><span class="line"></span><br><span class="line">    def calc(self, data, accum=0):</span><br><span class="line">        &quot;&quot;&quot;计算 CRC32 校验值&quot;&quot;&quot;</span><br><span class="line">        accum = ~accum</span><br><span class="line">        for b in data:</span><br><span class="line">            accum = self.table[(accum ^ b) &amp; 0xFF] ^ ((accum &gt;&gt; 8) &amp; 0x00FFFFFF)</span><br><span class="line">        accum = ~accum</span><br><span class="line">        return accum &amp; 0xFFFFFFFF</span><br><span class="line"></span><br><span class="line">    def find_reverse(self, desired, accum):</span><br><span class="line">        &quot;&quot;&quot;查找反向字节序列&quot;&quot;&quot;</span><br><span class="line">        solutions = set()</span><br><span class="line">        accum = ~accum</span><br><span class="line">        stack = [(~desired,)]</span><br><span class="line">        </span><br><span class="line">        while stack:</span><br><span class="line">            node = stack.pop()</span><br><span class="line">            for j in self.table_reverse[(node[0] &gt;&gt; 24) &amp; 0xFF]:</span><br><span class="line">                if len(node) == 4:</span><br><span class="line">                    a = accum</span><br><span class="line">                    data = []</span><br><span class="line">                    node = node[1:] + (j,)</span><br><span class="line">                    for i in range(3, -1, -1):</span><br><span class="line">                        data.append((a ^ node[i]) &amp; 0xFF)</span><br><span class="line">                        a &gt;&gt;= 8</span><br><span class="line">                        a ^= self.table[node[i]]</span><br><span class="line">                    solutions.add(tuple(data))</span><br><span class="line">                else:</span><br><span class="line">                    stack.append(((node[0] ^ self.table[j]) &lt;&lt; 8,) + node[1:] + (j,))</span><br><span class="line">        </span><br><span class="line">        return solutions</span><br><span class="line"></span><br><span class="line">    def dfs(self, length, outlist=[b&#x27;&#x27;]):</span><br><span class="line">        &quot;&quot;&quot;深度优先搜索生成字节序列&quot;&quot;&quot;</span><br><span class="line">        if length == 0:</span><br><span class="line">            return outlist</span><br><span class="line">        tmp_list = [item + bytes([x]) for item in outlist for x in self.char_set]</span><br><span class="line">        return self.dfs(length - 1, tmp_list)</span><br><span class="line"></span><br><span class="line">    def run_reverse(self):</span><br><span class="line">        &quot;&quot;&quot;执行 CRC32 反向查找&quot;&quot;&quot;</span><br><span class="line">        self.init_tables(self.poly)</span><br><span class="line"></span><br><span class="line">        desired = self.crc32</span><br><span class="line">        accum = self.accum</span><br><span class="line">        result_list = []</span><br><span class="line"></span><br><span class="line">        # 处理至少为 4 字节的情况</span><br><span class="line">        if self.length &gt;= 4:</span><br><span class="line">            patches = self.find_reverse(desired, accum)</span><br><span class="line">            for patch in patches:</span><br><span class="line">                checksum = self.calc(patch, accum)</span><br><span class="line">                # print(f&quot;verification checksum: 0x&#123;checksum:08x&#125; (&#123;&#x27;OK&#x27; if checksum == desired else &#x27;ERROR&#x27;&#125;)&quot;)</span><br><span class="line">            for item in self.dfs(self.length - 4):</span><br><span class="line">                patch = list(item)</span><br><span class="line">                patches = self.find_reverse(desired, self.calc(patch, accum))</span><br><span class="line">                for last_4_bytes in patches:</span><br><span class="line">                    patch.extend(last_4_bytes)</span><br><span class="line">                    checksum = self.calc(patch, accum)</span><br><span class="line">                    if checksum == desired:</span><br><span class="line">                        result_list.append(bytes(patch))  # 添加符合条件的字节序列</span><br><span class="line">        else:</span><br><span class="line">            for item in self.dfs(self.length):</span><br><span class="line">                if self.calc(item) == desired:</span><br><span class="line">                    result_list.append(bytes(item))  # 添加符合条件的字节序列</span><br><span class="line">        return result_list</span><br><span class="line"></span><br><span class="line">def crc32_reverse(crc32, length, char_set=bytes(range(256)), poly=0xEDB88320, accum=0):</span><br><span class="line">    obj = CRC32Reverse(crc32, length, char_set, poly, accum)</span><br><span class="line">    return obj.run_reverse()  # 返回所有结果</span><br><span class="line"></span><br><span class="line">def crc32(s):</span><br><span class="line">    return binascii.crc32(s) &amp; 0xFFFFFFFF</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    crc_values  =[0xcf60023f, 0x61d8a4f3, 0xb15f099f, 0xb93935f3, 0x56263d91, 0x7c9a17, 0x324af895, 0x64105f13, 0x7aae1d0a, 0x616c6729, 0x2b51c9d4, 0xb6e26299, 0xdff453c4, 0x9331116d, 0x324af895, 0x7c9a17, 0x7e2361b8, 0x7c65dfe1, 0x9e4be534, 0x324af895, 0x821fc2f0, 0x78e8a353, 0xac828282, 0x9e4be534, 0x6504596, 0xcaa8f9df, 0x64dc7498, 0x779f2fbd, 0x7b27b1d3, 0xcb9596dc, 0xaab6455d, 0xb72008ae, 0xb3ad741c, 0xa10773ef, 0x2b9de25f, 0x9b04f3b1, 0x48f88f87, 0xac828282, 0x821fc2f0, 0x6a2254af, 0xcaa8f9df, 0x3e3e4d70, 0x7b91940, 0x3c78f329, 0xe435b9ad, 0x6847643, 0x2c944a83, 0xc4a9dcdc, 0x9c0d5b6d, 0xa341cdb6, 0x358f7bc2, 0x13f3eab9, 0x6193621d, 0x159ed4a, 0x69a680c1, 0x4fb4a8, 0x70968761, 0x2f60fc5, 0x3937e5ac, 0x9b04f3b1, 0x1d26fc6f, 0x95fad386, 0x3937e5ac, 0x37c9c59b, 0xa341cdb6, 0xeb09f3ad, 0xa448656a, 0xab742f6a, 0x2090af1, 0xe435b9ad, 0xb26f1e2b, 0xecd468a4, 0x26cc20e7, 0x1ea22801, 0x64dc7498, 0x638602f4, 0x26b4c8b6, 0x61d8a4f3, 0xb15f099f, 0x88a078ba]</span><br><span class="line"></span><br><span class="line">    # print(len(crc_list))</span><br><span class="line">    res = b&quot;&quot;</span><br><span class="line">    for item in crc_values:</span><br><span class="line">        res += crc32_reverse(item, 4)[0]</span><br><span class="line">    print(res)</span><br><span class="line">    with open(&quot;res.bin&quot;,&#x27;wb&#x27;) as f:</span><br><span class="line">        f.write(res)</span><br></pre></td></tr></table></figure>

<p>这里crc_values是上一个脚本得到的数据</p>
<p>就是这里要注意最后一个压缩包中的 txt 是 3 字节，需要单独处理一下，所有CRC爆破结果合起来是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">53 29 00 00 CB AE 02 00 CB 2C 00 00 53 31 04 00</span><br><span class="line">D3 32 04 00 D3 32 02 00 D3 32 00 00 D3 32 06 00</span><br><span class="line">33 D5 02 00 33 B2 04 00 D3 32 01 00 33 34 06 00</span><br><span class="line">33 4D 04 00 33 4F 03 00 D3 32 00 00 D3 32 02 00</span><br><span class="line">33 D3 02 00 33 D0 02 00 33 36 05 00 D3 32 00 00</span><br><span class="line">33 31 04 00 33 D6 02 00 4B B6 00 00 33 36 05 00</span><br><span class="line">B3 48 06 00 4B B5 04 00 4B 35 03 00 B3 30 05 00</span><br><span class="line">B3 48 03 00 33 34 03 00 33 33 07 00 33 35 06 00</span><br><span class="line">33 33 06 00 33 4F 01 00 4B 35 04 00 33 31 05 00</span><br><span class="line">4B 31 00 00 4B B6 00 00 33 31 04 00 4B 4E 05 00</span><br><span class="line">4B B5 04 00 4B 4D 03 00 4B 31 07 00 4B 4E 03 00</span><br><span class="line">33 32 00 00 33 B0 00 00 4B 31 04 00 33 4E 05 00</span><br><span class="line">33 35 05 00 33 4C 01 00 4B 31 05 00 B3 30 01 00</span><br><span class="line">4B 32 03 00 B3 4C 06 00 4B 4C 05 00 33 B5 00 00</span><br><span class="line">B3 34 05 00 4B 36 07 00 4B 49 03 00 33 31 05 00</span><br><span class="line">4B 33 06 00 33 4A 03 00 4B 49 03 00 4B 32 05 00</span><br><span class="line">33 4C 01 00 33 48 06 00 33 48 01 00 33 32 07 00</span><br><span class="line">33 B6 00 00 33 32 00 00 33 32 06 00 B3 B4 00 00</span><br><span class="line">B3 34 03 00 4B 31 06 00 4B 35 03 00 D3 52 01 00</span><br><span class="line">D3 2F 00 00 CB AE 02 00 CB 2C 00 00 53 01 00</span><br></pre></td></tr></table></figure>

<p>把上面的数据按每4字节一组解压，可以得到一个zip的hash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import zlib</span><br><span class="line"></span><br><span class="line">hex_data = &quot;53290000CBAE0200CB2C000053310400D3320400D3320200D3320000D332060033D5020033B20400D332010033340600334D0400334F0300D3320000D332020033D3020033D0020033360500D33200003331040033D602004BB6000033360500B34806004BB504004B350300B3300500B348030033340300333307003335060033330600334F01004B350400333105004B3100004BB60000333104004B4E05004BB504004B4D03004B3107004B4E03003332000033B000004B310400334E050033350500334C01004B310500B33001004B320300B34C06004B4C050033B50000B33405004B3607004B490300333105004B330600334A03004B4903004B320500334C010033480600334801003332070033B600003332000033320600B3B40000B33403004B3106004B350300D3520100D32F0000CBAE0200CB2C0000530100&quot;</span><br><span class="line"></span><br><span class="line">data = bytes.fromhex(hex_data)</span><br><span class="line"></span><br><span class="line">chunks = [data[i:i+4] for i in range(0, len(data), 4)]</span><br><span class="line"></span><br><span class="line">out = b&quot;&quot;</span><br><span class="line">for c in chunks:</span><br><span class="line">    try:</span><br><span class="line">        out += zlib.decompress(c, -zlib.MAX_WBITS)</span><br><span class="line">    except:</span><br><span class="line">        print(&quot;bad chunk:&quot;, c.hex())</span><br><span class="line"></span><br><span class="line">print(out.decode())</span><br></pre></td></tr></table></figure>

<p>hash为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$pkzip$1*1*2*0*35*29*4135a7f*0*26*0*35*0413*c8358ce9e6858f166753637de145d0c841cee9efd7cf2008d13e551dd584b69cae5895c7df45f32fdfb51d0c0d273820239896d3e6*$/pkzip$</span><br></pre></td></tr></table></figure>

<p>参考2025 buckeyeCTF-zip2john2zip的wp:</p>
<p><a target="_blank" rel="noopener" href="https://github.com/cscosu/buckeyectf-2025-public/blob/master/forensics/zip2john2zip/solve/solve.py">https://github.com/cscosu/buckeyectf-2025-public/blob/master/forensics/zip2john2zip/solve/solve.py</a></p>
<p>已知三个内部密钥和哈希值，还原 zip 并解压缩：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">def pkcrc(x, b):</span><br><span class="line">    x = (x ^ b) &amp; 0xFFFFFFFF </span><br><span class="line">    for _ in range(8):</span><br><span class="line">        if x &amp; 1:</span><br><span class="line">            x = (x &gt;&gt; 1) ^ 0xedb88320</span><br><span class="line">        else:</span><br><span class="line">            x &gt;&gt;= 1</span><br><span class="line">    return x &amp; 0xFFFFFFFF</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def decrypt_stream_with_keys(enc, key0, key1, key2):</span><br><span class="line"></span><br><span class="line">    def _update_keys(byte_val):</span><br><span class="line">        nonlocal key0, key1, key2</span><br><span class="line">        key0 = pkcrc(key0, byte_val)</span><br><span class="line">        temp = (key1 + (key0 &amp; 0xff)) &amp; 0xFFFFFFFF</span><br><span class="line">        key1 = (((temp * 0x08088405) &amp; 0xFFFFFFFF) + 1) &amp; 0xFFFFFFFF</span><br><span class="line">        key2 = pkcrc(key2, (key1 &gt;&gt; 24) &amp; 0xff)</span><br><span class="line"></span><br><span class="line">    def _get_keystream_byte():</span><br><span class="line">        nonlocal key2</span><br><span class="line">        temp = (key2 &amp; 0xFFFF) | 3</span><br><span class="line">        return (((temp * (temp ^ 1)) &amp; 0xFFFF) &gt;&gt; 8) &amp; 0xff</span><br><span class="line"></span><br><span class="line">    out = bytearray()</span><br><span class="line">    for e in enc:</span><br><span class="line">        ks = _get_keystream_byte()</span><br><span class="line">        d = e ^ ks</span><br><span class="line">        out.append(d)</span><br><span class="line">        _update_keys(d)</span><br><span class="line"></span><br><span class="line">    return bytes(out)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    # your recovered keys:</span><br><span class="line">    k0 = 0xb47e923c</span><br><span class="line">    k1 = 0x5aeb49a7</span><br><span class="line">    k2 = 0xa3cd7af0</span><br><span class="line"></span><br><span class="line">    # encrypted data from $pkzip$ hash</span><br><span class="line">    hash_text = &quot;$pkzip$1*1*2*0*35*29*4135a7f*0*26*0*35*0413*c8358ce9e6858f166753637de145d0c841cee9efd7cf2008d13e551dd584b69cae5895c7df45f32fdfb51d0c0d273820239896d3e6*$/pkzip$&quot;</span><br><span class="line">    enc_hex = hash_text.split(&#x27;*&#x27;)[12]  # not 13 !</span><br><span class="line">    enc = bytes.fromhex(enc_hex)</span><br><span class="line"></span><br><span class="line">    plain = decrypt_stream_with_keys(enc, k0, k1, k2)</span><br><span class="line">    print(plain)</span><br><span class="line">#b&#x27;\xcf\xecP\x1f\x89\x9e\x83q1&quot;\xa4\x04flag&#123;W0ww_th3_C@ske7|s_Tre4sur3_unl0cke9&#125;&#x27;</span><br></pre></td></tr></table></figure>

<p>得到<strong>flag{W0ww_th3_C@ske7|s_Tre4sur3_unl0cke9}</strong></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://tgvhzg.github.io">JiuCheng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://tgvhzg.github.io/2025/12/18/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E7%BA%BF%E4%B8%8BMisc%E5%A4%8D%E7%8E%B0/">https://tgvhzg.github.io/2025/12/18/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E7%BA%BF%E4%B8%8BMisc%E5%A4%8D%E7%8E%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wp/">wp</a></div><div class="post-share"><div class="social-share" data-image="/pic/back.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/12/20/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81-volatility3%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" title="内存取证-volatility3工具的使用"><img class="cover" src="/pic/back3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">内存取证-volatility3工具的使用</div></div><div class="info-2"><div class="info-item-1">内存取证-volatility3工具的使用安装 下载 (下载最新的源码包)  1wget https://github.com/volatilityfoundation/volatility3/archive/refs/tags/v2.5.2.zip -O volatility3.zip   解压  1unzip volatility3.zip   安装依赖（这是 Vol 3 必须多做的一步）  Volatility3需要一些Python库才能工作，不装会报错 12cd volatility3-2.5.2pip3 install -r requirements.txt  当然在这一步，可以会遇到下面这种情况：  这里需要创建一个虚拟环境，就可以正常安装依赖了 12345678#安装 venv 模块 (如果尚未安装)sudo apt install -y python3-venv#创建名为 venv 的虚拟环境python3 -m venv 虚拟环境名#激活虚拟环境source 虚拟环境名/bin/activate  1pip install -r requirements.txt...</div></div></div></a><a class="pagination-related" href="/2025/11/14/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/" title="区块链智能合约"><img class="cover" src="/pic/back1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">区块链智能合约</div></div><div class="info-2"><div class="info-item-1">区块链智能合约欢迎来到Blockchain方向！在CTF里，这个方向主要侧重于智能合约安全，题目的主要形式是提供题目合约，要求进行合约审计并且找到合约中的漏洞并利用它达成某一目的（比如修改solved变量），当然还有其它的类型，比如提供字节码然后进行EVM字节码逆向，然后再利用合约漏洞等。 目前智能合约的主流语言是Solidity 文章参考：https://cauliweak9.github.io/2024/04/28/Blockchain-Guide/ 靶场：靶场的话先刷https://ethernaut.openzeppelin.com/这个人有全wphttps://exp10it.io/2024/04/ethernaut-writeup/#puzzle-wallet这个比较难 https://onlypwner.xyz/challenges 后面再刷 （一）准备工作：1.钱包121.MetaMask语言：Solidity  1232.PhantomSolana链强制需要语言：Rust  1233.Sui WalletSui链需要语言：Move  2.编写代码IDE编写Sol...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/12/21/DASCTF2025%E4%B8%8B%E5%8D%8A%E5%B9%B4%E8%B5%9B/" title="DASCTF2025下半年赛Misc复现"><img class="cover" src="/pic/back2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-21</div><div class="info-item-2">DASCTF2025下半年赛Misc复现</div></div><div class="info-2"><div class="info-item-1">DASCTF2025下半年赛Misc官方wp： https://www.yuque.com/chuangfeimeiyigeren/eeii37/pyuic5kgzp3xe3tg?singleDoc#RCpLM DigitalSignature题目描述： 12Find out the signer. Maybe you need EIP-191. Flag is account address that wrapped by DASCTF&#123;&#125;.找出签名者。可能需要使用EIP-191。Flag是包裹在DASCTF&#123;&#125;中的账户地址。  附件task.py内容为： 12345678910111213141516171819202122232425262728293031from web3 import Web3from eth_account.messages import encode_defunctfrom Crypto.Util.number import bytes_to_longdef SignMessage(Message: str,...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/pic/head1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">JiuCheng</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/TGVhZg"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is JiuCheng's Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E7%BA%BF%E4%B8%8BMisc%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.</span> <span class="toc-text">强网拟态线下Misc复现</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%84%E6%BC%8F%E7%9A%84%E6%97%B6%E9%97%B4%E4%B8%8E%E7%94%B5%E7%A0%81"><span class="toc-number">1.1.</span> <span class="toc-text">泄漏的时间与电码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%94%E7%92%9E%E5%BD%92%E7%9C%9F"><span class="toc-number">1.2.</span> <span class="toc-text">返璞归真</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8C%AB%E5%92%AA%E7%94%B5%E5%8F%B0"><span class="toc-number">1.3.</span> <span class="toc-text">猫咪电台</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E7%9A%84%E7%BB%9D%E5%AF%86%E5%8E%8B%E7%BC%A9"><span class="toc-number">1.4.</span> <span class="toc-text">标准的绝密压缩</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/12/25/pyminifier/" title="pyminifier混淆器"><img src="/pic/back5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pyminifier混淆器"/></a><div class="content"><a class="title" href="/2025/12/25/pyminifier/" title="pyminifier混淆器">pyminifier混淆器</a><time datetime="2025-12-25T05:01:15.079Z" title="Created 2025-12-25 13:01:15">2025-12-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/22/zip%E5%B7%B2%E7%9F%A5%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/" title="zip已知明文攻击"><img src="/pic/back4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="zip已知明文攻击"/></a><div class="content"><a class="title" href="/2025/12/22/zip%E5%B7%B2%E7%9F%A5%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/" title="zip已知明文攻击">zip已知明文攻击</a><time datetime="2025-12-22T10:22:16.691Z" title="Created 2025-12-22 18:22:16">2025-12-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/21/DASCTF2025%E4%B8%8B%E5%8D%8A%E5%B9%B4%E8%B5%9B/" title="DASCTF2025下半年赛Misc复现"><img src="/pic/back2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DASCTF2025下半年赛Misc复现"/></a><div class="content"><a class="title" href="/2025/12/21/DASCTF2025%E4%B8%8B%E5%8D%8A%E5%B9%B4%E8%B5%9B/" title="DASCTF2025下半年赛Misc复现">DASCTF2025下半年赛Misc复现</a><time datetime="2025-12-21T04:23:18.722Z" title="Created 2025-12-21 12:23:18">2025-12-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/20/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81-volatility3%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" title="内存取证-volatility3工具的使用"><img src="/pic/back3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内存取证-volatility3工具的使用"/></a><div class="content"><a class="title" href="/2025/12/20/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81-volatility3%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" title="内存取证-volatility3工具的使用">内存取证-volatility3工具的使用</a><time datetime="2025-12-20T12:54:23.744Z" title="Created 2025-12-20 20:54:23">2025-12-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/18/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E7%BA%BF%E4%B8%8BMisc%E5%A4%8D%E7%8E%B0/" title="强网拟态线下Misc复现"><img src="/pic/back.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="强网拟态线下Misc复现"/></a><div class="content"><a class="title" href="/2025/12/18/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E7%BA%BF%E4%B8%8BMisc%E5%A4%8D%E7%8E%B0/" title="强网拟态线下Misc复现">强网拟态线下Misc复现</a><time datetime="2025-12-18T02:46:04.220Z" title="Created 2025-12-18 10:46:04">2025-12-18</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/pic/top_foot_img.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By JiuCheng</span></div><div class="footer_custom_text">I'm JiuCheng</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>